import{Y as wr,G as Tr,X as Cr,a as Fr,ab as ir,m as pn,k as Dr,S as Er,i as gn,c as mn,I as Mr,T as Gt,o as Or,g as Wn,a7 as Ar,f as Nn,aG as yn,t as Ir,y as Rr,bR as Gr,bS as Br,bT as Lr,bU as Pr,s as jr,bV as zr}from"./index-Bm04Wswa.js";function Wr(){var c=Object.create(null);function n(t,e){var a=t.id,o=t.name,r=t.dependencies;r===void 0&&(r=[]);var i=t.init;i===void 0&&(i=function(){});var s=t.getTransferables;if(s===void 0&&(s=null),!c[a])try{r=r.map(function(u){return u&&u.isWorkerModule&&(n(u,function(f){if(f instanceof Error)throw f}),u=c[u.id].value),u}),i=h("<"+o+">.init",i),s&&(s=h("<"+o+">.getTransferables",s));var l=null;typeof i=="function"?l=i.apply(void 0,r):console.error("worker module init function failed to rehydrate"),c[a]={id:a,value:l,getTransferables:s},e(l)}catch(u){u&&u.noLog||console.error(u),e(u)}}function d(t,e){var a,o=t.id,r=t.args;(!c[o]||typeof c[o].value!="function")&&e(new Error("Worker module "+o+": not found or its 'init' did not return a function"));try{var i=(a=c[o]).value.apply(a,r);i&&typeof i.then=="function"?i.then(s,function(l){return e(l instanceof Error?l:new Error(""+l))}):s(i)}catch(l){e(l)}function s(l){try{var u=c[o].getTransferables&&c[o].getTransferables(l);(!u||!Array.isArray(u)||!u.length)&&(u=void 0),e(l,u)}catch(f){console.error(f),e(f)}}}function h(t,e){var a=void 0;self.troikaDefine=function(r){return a=r};var o=URL.createObjectURL(new Blob(["/** "+t.replace(/\*/g,"")+` **/

troikaDefine(
`+e+`
)`],{type:"application/javascript"}));try{importScripts(o)}catch(r){console.error(r)}return URL.revokeObjectURL(o),delete self.troikaDefine,a}self.addEventListener("message",function(t){var e=t.data,a=e.messageId,o=e.action,r=e.data;try{o==="registerModule"&&n(r,function(i){i instanceof Error?postMessage({messageId:a,success:!1,error:i.message}):postMessage({messageId:a,success:!0,result:{isCallable:typeof i=="function"}})}),o==="callModule"&&d(r,function(i,s){i instanceof Error?postMessage({messageId:a,success:!1,error:i.message}):postMessage({messageId:a,success:!0,result:i},s||void 0)})}catch(i){postMessage({messageId:a,success:!1,error:i.stack})}})}function Nr(c){var n=function(){for(var d=[],h=arguments.length;h--;)d[h]=arguments[h];return n._getInitResult().then(function(t){if(typeof t=="function")return t.apply(void 0,d);throw new Error("Worker module function was called but `init` did not return a callable function")})};return n._getInitResult=function(){var d=c.dependencies,h=c.init;d=Array.isArray(d)?d.map(function(e){return e&&e._getInitResult?e._getInitResult():e}):[];var t=Promise.all(d).then(function(e){return h.apply(null,e)});return n._getInitResult=function(){return t},t},n}var sr=function(){var c=!1;if(typeof window<"u"&&typeof window.document<"u")try{var n=new Worker(URL.createObjectURL(new Blob([""],{type:"application/javascript"})));n.terminate(),c=!0}catch(d){console.log("Troika createWorkerModule: web workers not allowed; falling back to main thread execution. Cause: ["+d.message+"]")}return sr=function(){return c},c},Xr=0,Vr=0,sn=!1,mt=Object.create(null),yt=Object.create(null),hn=Object.create(null);function ot(c){if((!c||typeof c.init!="function")&&!sn)throw new Error("requires `options.init` function");var n=c.dependencies,d=c.init,h=c.getTransferables,t=c.workerId;if(!sr())return Nr(c);t==null&&(t="#default");var e="workerModule"+ ++Xr,a=c.name||e,o=null;n=n&&n.map(function(i){return typeof i=="function"&&!i.workerModuleData&&(sn=!0,i=ot({workerId:t,name:"<"+a+"> function dependency: "+i.name,init:`function(){return (
`+It(i)+`
)}`}),sn=!1),i&&i.workerModuleData&&(i=i.workerModuleData),i});function r(){for(var i=[],s=arguments.length;s--;)i[s]=arguments[s];if(!o){o=Xn(t,"registerModule",r.workerModuleData);var l=function(){o=null,yt[t].delete(l)};(yt[t]||(yt[t]=new Set)).add(l)}return o.then(function(u){var f=u.isCallable;if(f)return Xn(t,"callModule",{id:e,args:i});throw new Error("Worker module function was called but `init` did not return a callable function")})}return r.workerModuleData={isWorkerModule:!0,id:e,name:a,dependencies:n,init:It(d),getTransferables:h&&It(h)},r}function $r(c){yt[c]&&yt[c].forEach(function(n){n()}),mt[c]&&(mt[c].terminate(),delete mt[c])}function It(c){var n=c.toString();return!/^function/.test(n)&&/^\w+\s*\(/.test(n)&&(n="function "+n),n}function Hr(c){var n=mt[c];if(!n){var d=It(Wr);n=mt[c]=new Worker(URL.createObjectURL(new Blob(["/** Worker Module Bootstrap: "+c.replace(/\*/g,"")+` **/

;(`+d+")()"],{type:"application/javascript"}))),n.onmessage=function(h){var t=h.data,e=t.messageId,a=hn[e];if(!a)throw new Error("WorkerModule response with empty or unknown messageId");delete hn[e],a(t)}}return n}function Xn(c,n,d){return new Promise(function(h,t){var e=++Vr;hn[e]=function(a){a.success?h(a.result):t(new Error("Error in worker "+n+" call: "+a.error))},Hr(c).postMessage({messageId:e,action:n,data:d})})}function lr(){var c=(function(n){function d(R,I,v,b,w,T,U,P){var M=1-U;P.x=M*M*R+2*M*U*v+U*U*w,P.y=M*M*I+2*M*U*b+U*U*T}function h(R,I,v,b,w,T,U,P,M,L){var H=1-M;L.x=H*H*H*R+3*H*H*M*v+3*H*M*M*w+M*M*M*U,L.y=H*H*H*I+3*H*H*M*b+3*H*M*M*T+M*M*M*P}function t(R,I){for(var v=/([MLQCZ])([^MLQCZ]*)/g,b,w,T,U,P;b=v.exec(R);){var M=b[2].replace(/^\s*|\s*$/g,"").split(/[,\s]+/).map(function(L){return parseFloat(L)});switch(b[1]){case"M":U=w=M[0],P=T=M[1];break;case"L":(M[0]!==U||M[1]!==P)&&I("L",U,P,U=M[0],P=M[1]);break;case"Q":{I("Q",U,P,U=M[2],P=M[3],M[0],M[1]);break}case"C":{I("C",U,P,U=M[4],P=M[5],M[0],M[1],M[2],M[3]);break}case"Z":(U!==w||P!==T)&&I("L",U,P,w,T);break}}}function e(R,I,v){v===void 0&&(v=16);var b={x:0,y:0};t(R,function(w,T,U,P,M,L,H,Q,X){switch(w){case"L":I(T,U,P,M);break;case"Q":{for(var z=T,fe=U,he=1;he<v;he++)d(T,U,L,H,P,M,he/(v-1),b),I(z,fe,b.x,b.y),z=b.x,fe=b.y;break}case"C":{for(var ne=T,J=U,le=1;le<v;le++)h(T,U,L,H,Q,X,P,M,le/(v-1),b),I(ne,J,b.x,b.y),ne=b.x,J=b.y;break}}})}var a="precision highp float;attribute vec2 aUV;varying vec2 vUV;void main(){vUV=aUV;gl_Position=vec4(mix(vec2(-1.0),vec2(1.0),aUV),0.0,1.0);}",o="precision highp float;uniform sampler2D tex;varying vec2 vUV;void main(){gl_FragColor=texture2D(tex,vUV);}",r=new WeakMap,i={premultipliedAlpha:!1,preserveDrawingBuffer:!0,antialias:!1,depth:!1};function s(R,I){var v=R.getContext?R.getContext("webgl",i):R,b=r.get(v);if(!b){let H=function(ne){var J=T[ne];if(!J&&(J=T[ne]=v.getExtension(ne),!J))throw new Error(ne+" not supported");return J},Q=function(ne,J){var le=v.createShader(J);return v.shaderSource(le,ne),v.compileShader(le),le},X=function(ne,J,le,j){if(!U[ne]){var oe={},Y={},B=v.createProgram();v.attachShader(B,Q(J,v.VERTEX_SHADER)),v.attachShader(B,Q(le,v.FRAGMENT_SHADER)),v.linkProgram(B),U[ne]={program:B,transaction:function(pe){v.useProgram(B),pe({setUniform:function(q,ee){for(var K=[],te=arguments.length-2;te-- >0;)K[te]=arguments[te+2];var ge=Y[ee]||(Y[ee]=v.getUniformLocation(B,ee));v["uniform"+q].apply(v,[ge].concat(K))},setAttribute:function(q,ee,K,te,ge){var Z=oe[q];Z||(Z=oe[q]={buf:v.createBuffer(),loc:v.getAttribLocation(B,q),data:null}),v.bindBuffer(v.ARRAY_BUFFER,Z.buf),v.vertexAttribPointer(Z.loc,ee,v.FLOAT,!1,0,0),v.enableVertexAttribArray(Z.loc),w?v.vertexAttribDivisor(Z.loc,te):H("ANGLE_instanced_arrays").vertexAttribDivisorANGLE(Z.loc,te),ge!==Z.data&&(v.bufferData(v.ARRAY_BUFFER,ge,K),Z.data=ge)}})}}}U[ne].transaction(j)},z=function(ne,J){M++;try{v.activeTexture(v.TEXTURE0+M);var le=P[ne];le||(le=P[ne]=v.createTexture(),v.bindTexture(v.TEXTURE_2D,le),v.texParameteri(v.TEXTURE_2D,v.TEXTURE_MIN_FILTER,v.NEAREST),v.texParameteri(v.TEXTURE_2D,v.TEXTURE_MAG_FILTER,v.NEAREST)),v.bindTexture(v.TEXTURE_2D,le),J(le,M)}finally{M--}},fe=function(ne,J,le){var j=v.createFramebuffer();L.push(j),v.bindFramebuffer(v.FRAMEBUFFER,j),v.activeTexture(v.TEXTURE0+J),v.bindTexture(v.TEXTURE_2D,ne),v.framebufferTexture2D(v.FRAMEBUFFER,v.COLOR_ATTACHMENT0,v.TEXTURE_2D,ne,0);try{le(j)}finally{v.deleteFramebuffer(j),v.bindFramebuffer(v.FRAMEBUFFER,L[--L.length-1]||null)}},he=function(){T={},U={},P={},M=-1,L.length=0};var w=typeof WebGL2RenderingContext<"u"&&v instanceof WebGL2RenderingContext,T={},U={},P={},M=-1,L=[];v.canvas.addEventListener("webglcontextlost",function(ne){he(),ne.preventDefault()},!1),r.set(v,b={gl:v,isWebGL2:w,getExtension:H,withProgram:X,withTexture:z,withTextureFramebuffer:fe,handleContextLoss:he})}I(b)}function l(R,I,v,b,w,T,U,P){U===void 0&&(U=15),P===void 0&&(P=null),s(R,function(M){var L=M.gl,H=M.withProgram,Q=M.withTexture;Q("copy",function(X,z){L.texImage2D(L.TEXTURE_2D,0,L.RGBA,w,T,0,L.RGBA,L.UNSIGNED_BYTE,I),H("copy",a,o,function(fe){var he=fe.setUniform,ne=fe.setAttribute;ne("aUV",2,L.STATIC_DRAW,0,new Float32Array([0,0,2,0,0,2])),he("1i","image",z),L.bindFramebuffer(L.FRAMEBUFFER,P||null),L.disable(L.BLEND),L.colorMask(U&8,U&4,U&2,U&1),L.viewport(v,b,w,T),L.scissor(v,b,w,T),L.drawArrays(L.TRIANGLES,0,3)})})})}function u(R,I,v){var b=R.width,w=R.height;s(R,function(T){var U=T.gl,P=new Uint8Array(b*w*4);U.readPixels(0,0,b,w,U.RGBA,U.UNSIGNED_BYTE,P),R.width=I,R.height=v,l(U,P,0,0,b,w)})}var f=Object.freeze({__proto__:null,withWebGLContext:s,renderImageData:l,resizeWebGLCanvasWithoutClearing:u});function p(R,I,v,b,w,T){T===void 0&&(T=1);var U=new Uint8Array(R*I),P=b[2]-b[0],M=b[3]-b[1],L=[];e(v,function(ne,J,le,j){L.push({x1:ne,y1:J,x2:le,y2:j,minX:Math.min(ne,le),minY:Math.min(J,j),maxX:Math.max(ne,le),maxY:Math.max(J,j)})}),L.sort(function(ne,J){return ne.maxX-J.maxX});for(var H=0;H<R;H++)for(var Q=0;Q<I;Q++){var X=fe(b[0]+P*(H+.5)/R,b[1]+M*(Q+.5)/I),z=Math.pow(1-Math.abs(X)/w,T)/2;X<0&&(z=1-z),z=Math.max(0,Math.min(255,Math.round(z*255))),U[Q*R+H]=z}return U;function fe(ne,J){for(var le=1/0,j=1/0,oe=L.length;oe--;){var Y=L[oe];if(Y.maxX+j<=ne)break;if(ne+j>Y.minX&&J-j<Y.maxY&&J+j>Y.minY){var B=O(ne,J,Y.x1,Y.y1,Y.x2,Y.y2);B<le&&(le=B,j=Math.sqrt(le))}}return he(ne,J)&&(j=-j),j}function he(ne,J){for(var le=0,j=L.length;j--;){var oe=L[j];if(oe.maxX<=ne)break;var Y=oe.y1>J!=oe.y2>J&&ne<(oe.x2-oe.x1)*(J-oe.y1)/(oe.y2-oe.y1)+oe.x1;Y&&(le+=oe.y1<oe.y2?1:-1)}return le!==0}}function m(R,I,v,b,w,T,U,P,M,L){T===void 0&&(T=1),P===void 0&&(P=0),M===void 0&&(M=0),L===void 0&&(L=0),y(R,I,v,b,w,T,U,null,P,M,L)}function y(R,I,v,b,w,T,U,P,M,L,H){T===void 0&&(T=1),M===void 0&&(M=0),L===void 0&&(L=0),H===void 0&&(H=0);for(var Q=p(R,I,v,b,w,T),X=new Uint8Array(Q.length*4),z=0;z<Q.length;z++)X[z*4+H]=Q[z];l(U,X,M,L,R,I,1<<3-H,P)}function O(R,I,v,b,w,T){var U=w-v,P=T-b,M=U*U+P*P,L=M?Math.max(0,Math.min(1,((R-v)*U+(I-b)*P)/M)):0,H=R-(v+L*U),Q=I-(b+L*P);return H*H+Q*Q}var F=Object.freeze({__proto__:null,generate:p,generateIntoCanvas:m,generateIntoFramebuffer:y}),C="precision highp float;uniform vec4 uGlyphBounds;attribute vec2 aUV;attribute vec4 aLineSegment;varying vec4 vLineSegment;varying vec2 vGlyphXY;void main(){vLineSegment=aLineSegment;vGlyphXY=mix(uGlyphBounds.xy,uGlyphBounds.zw,aUV);gl_Position=vec4(mix(vec2(-1.0),vec2(1.0),aUV),0.0,1.0);}",x="precision highp float;uniform vec4 uGlyphBounds;uniform float uMaxDistance;uniform float uExponent;varying vec4 vLineSegment;varying vec2 vGlyphXY;float absDistToSegment(vec2 point,vec2 lineA,vec2 lineB){vec2 lineDir=lineB-lineA;float lenSq=dot(lineDir,lineDir);float t=lenSq==0.0 ? 0.0 : clamp(dot(point-lineA,lineDir)/lenSq,0.0,1.0);vec2 linePt=lineA+t*lineDir;return distance(point,linePt);}void main(){vec4 seg=vLineSegment;vec2 p=vGlyphXY;float dist=absDistToSegment(p,seg.xy,seg.zw);float val=pow(1.0-clamp(dist/uMaxDistance,0.0,1.0),uExponent)*0.5;bool crossing=(seg.y>p.y!=seg.w>p.y)&&(p.x<(seg.z-seg.x)*(p.y-seg.y)/(seg.w-seg.y)+seg.x);bool crossingUp=crossing&&vLineSegment.y<vLineSegment.w;gl_FragColor=vec4(crossingUp ? 1.0/255.0 : 0.0,crossing&&!crossingUp ? 1.0/255.0 : 0.0,0.0,val);}",k="precision highp float;uniform sampler2D tex;varying vec2 vUV;void main(){vec4 color=texture2D(tex,vUV);bool inside=color.r!=color.g;float val=inside ? 1.0-color.a : color.a;gl_FragColor=vec4(val);}",A=new Float32Array([0,0,2,0,0,2]),S=null,_=!1,G={},W=new WeakMap;function $(R){if(!_&&!V(R))throw new Error("WebGL generation not supported")}function g(R,I,v,b,w,T,U){if(T===void 0&&(T=1),U===void 0&&(U=null),!U&&(U=S,!U)){var P=typeof OffscreenCanvas=="function"?new OffscreenCanvas(1,1):typeof document<"u"?document.createElement("canvas"):null;if(!P)throw new Error("OffscreenCanvas or DOM canvas not supported");U=S=P.getContext("webgl",{depth:!1})}$(U);var M=new Uint8Array(R*I*4);s(U,function(X){var z=X.gl,fe=X.withTexture,he=X.withTextureFramebuffer;fe("readable",function(ne,J){z.texImage2D(z.TEXTURE_2D,0,z.RGBA,R,I,0,z.RGBA,z.UNSIGNED_BYTE,null),he(ne,J,function(le){D(R,I,v,b,w,T,z,le,0,0,0),z.readPixels(0,0,R,I,z.RGBA,z.UNSIGNED_BYTE,M)})})});for(var L=new Uint8Array(R*I),H=0,Q=0;H<M.length;H+=4)L[Q++]=M[H];return L}function E(R,I,v,b,w,T,U,P,M,L){T===void 0&&(T=1),P===void 0&&(P=0),M===void 0&&(M=0),L===void 0&&(L=0),D(R,I,v,b,w,T,U,null,P,M,L)}function D(R,I,v,b,w,T,U,P,M,L,H){T===void 0&&(T=1),M===void 0&&(M=0),L===void 0&&(L=0),H===void 0&&(H=0),$(U);var Q=[];e(v,function(X,z,fe,he){Q.push(X,z,fe,he)}),Q=new Float32Array(Q),s(U,function(X){var z=X.gl,fe=X.isWebGL2,he=X.getExtension,ne=X.withProgram,J=X.withTexture,le=X.withTextureFramebuffer,j=X.handleContextLoss;if(J("rawDistances",function(oe,Y){(R!==oe._lastWidth||I!==oe._lastHeight)&&z.texImage2D(z.TEXTURE_2D,0,z.RGBA,oe._lastWidth=R,oe._lastHeight=I,0,z.RGBA,z.UNSIGNED_BYTE,null),ne("main",C,x,function(B){var pe=B.setAttribute,q=B.setUniform,ee=!fe&&he("ANGLE_instanced_arrays"),K=!fe&&he("EXT_blend_minmax");pe("aUV",2,z.STATIC_DRAW,0,A),pe("aLineSegment",4,z.DYNAMIC_DRAW,1,Q),q.apply(void 0,["4f","uGlyphBounds"].concat(b)),q("1f","uMaxDistance",w),q("1f","uExponent",T),le(oe,Y,function(te){z.enable(z.BLEND),z.colorMask(!0,!0,!0,!0),z.viewport(0,0,R,I),z.scissor(0,0,R,I),z.blendFunc(z.ONE,z.ONE),z.blendEquationSeparate(z.FUNC_ADD,fe?z.MAX:K.MAX_EXT),z.clear(z.COLOR_BUFFER_BIT),fe?z.drawArraysInstanced(z.TRIANGLES,0,3,Q.length/4):ee.drawArraysInstancedANGLE(z.TRIANGLES,0,3,Q.length/4)})}),ne("post",a,k,function(B){B.setAttribute("aUV",2,z.STATIC_DRAW,0,A),B.setUniform("1i","tex",Y),z.bindFramebuffer(z.FRAMEBUFFER,P),z.disable(z.BLEND),z.colorMask(H===0,H===1,H===2,H===3),z.viewport(M,L,R,I),z.scissor(M,L,R,I),z.drawArrays(z.TRIANGLES,0,3)})}),z.isContextLost())throw j(),new Error("webgl context lost")})}function V(R){var I=!R||R===S?G:R.canvas||R,v=W.get(I);if(v===void 0){_=!0;var b=null;try{var w=[97,106,97,61,99,137,118,80,80,118,137,99,61,97,106,97],T=g(4,4,"M8,8L16,8L24,24L16,24Z",[0,0,32,32],24,1,R);v=T&&w.length===T.length&&T.every(function(U,P){return U===w[P]}),v||(b="bad trial run results",console.info(w,T))}catch(U){v=!1,b=U.message}b&&console.warn("WebGL SDF generation not supported:",b),_=!1,W.set(I,v)}return v}var N=Object.freeze({__proto__:null,generate:g,generateIntoCanvas:E,generateIntoFramebuffer:D,isSupported:V});function re(R,I,v,b,w,T){w===void 0&&(w=Math.max(b[2]-b[0],b[3]-b[1])/2),T===void 0&&(T=1);try{return g.apply(N,arguments)}catch(U){return console.info("WebGL SDF generation failed, falling back to JS",U),p.apply(F,arguments)}}function se(R,I,v,b,w,T,U,P,M,L){w===void 0&&(w=Math.max(b[2]-b[0],b[3]-b[1])/2),T===void 0&&(T=1),P===void 0&&(P=0),M===void 0&&(M=0),L===void 0&&(L=0);try{return E.apply(N,arguments)}catch(H){return console.info("WebGL SDF generation failed, falling back to JS",H),m.apply(F,arguments)}}return n.forEachPathCommand=t,n.generate=re,n.generateIntoCanvas=se,n.javascript=F,n.pathToLineSegments=e,n.webgl=N,n.webglUtils=f,Object.defineProperty(n,"__esModule",{value:!0}),n})({});return c}function Yr(){var c=(function(n){var d={R:"13k,1a,2,3,3,2+1j,ch+16,a+1,5+2,2+n,5,a,4,6+16,4+3,h+1b,4mo,179q,2+9,2+11,2i9+7y,2+68,4,3+4,5+13,4+3,2+4k,3+29,8+cf,1t+7z,w+17,3+3m,1t+3z,16o1+5r,8+30,8+mc,29+1r,29+4v,75+73",EN:"1c+9,3d+1,6,187+9,513,4+5,7+9,sf+j,175h+9,qw+q,161f+1d,4xt+a,25i+9",ES:"17,2,6dp+1,f+1,av,16vr,mx+1,4o,2",ET:"z+2,3h+3,b+1,ym,3e+1,2o,p4+1,8,6u,7c,g6,1wc,1n9+4,30+1b,2n,6d,qhx+1,h0m,a+1,49+2,63+1,4+1,6bb+3,12jj",AN:"16o+5,2j+9,2+1,35,ed,1ff2+9,87+u",CS:"18,2+1,b,2u,12k,55v,l,17v0,2,3,53,2+1,b",B:"a,3,f+2,2v,690",S:"9,2,k",WS:"c,k,4f4,1vk+a,u,1j,335",ON:"x+1,4+4,h+5,r+5,r+3,z,5+3,2+1,2+1,5,2+2,3+4,o,w,ci+1,8+d,3+d,6+8,2+g,39+1,9,6+1,2,33,b8,3+1,3c+1,7+1,5r,b,7h+3,sa+5,2,3i+6,jg+3,ur+9,2v,ij+1,9g+9,7+a,8m,4+1,49+x,14u,2+2,c+2,e+2,e+2,e+1,i+n,e+e,2+p,u+2,e+2,36+1,2+3,2+1,b,2+2,6+5,2,2,2,h+1,5+4,6+3,3+f,16+2,5+3l,3+81,1y+p,2+40,q+a,m+13,2r+ch,2+9e,75+hf,3+v,2+2w,6e+5,f+6,75+2a,1a+p,2+2g,d+5x,r+b,6+3,4+o,g,6+1,6+2,2k+1,4,2j,5h+z,1m+1,1e+f,t+2,1f+e,d+3,4o+3,2s+1,w,535+1r,h3l+1i,93+2,2s,b+1,3l+x,2v,4g+3,21+3,kz+1,g5v+1,5a,j+9,n+v,2,3,2+8,2+1,3+2,2,3,46+1,4+4,h+5,r+5,r+a,3h+2,4+6,b+4,78,1r+24,4+c,4,1hb,ey+6,103+j,16j+c,1ux+7,5+g,fsh,jdq+1t,4,57+2e,p1,1m,1m,1m,1m,4kt+1,7j+17,5+2r,d+e,3+e,2+e,2+10,m+4,w,1n+5,1q,4z+5,4b+rb,9+c,4+c,4+37,d+2g,8+b,l+b,5+1j,9+9,7+13,9+t,3+1,27+3c,2+29,2+3q,d+d,3+4,4+2,6+6,a+o,8+6,a+2,e+6,16+42,2+1i",BN:"0+8,6+d,2s+5,2+p,e,4m9,1kt+2,2b+5,5+5,17q9+v,7k,6p+8,6+1,119d+3,440+7,96s+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+75,6p+2rz,1ben+1,1ekf+1,1ekf+1",NSM:"lc+33,7o+6,7c+18,2,2+1,2+1,2,21+a,1d+k,h,2u+6,3+5,3+1,2+3,10,v+q,2k+a,1n+8,a,p+3,2+8,2+2,2+4,18+2,3c+e,2+v,1k,2,5+7,5,4+6,b+1,u,1n,5+3,9,l+1,r,3+1,1m,5+1,5+1,3+2,4,v+1,4,c+1,1m,5+4,2+1,5,l+1,n+5,2,1n,3,2+3,9,8+1,c+1,v,1q,d,1f,4,1m+2,6+2,2+3,8+1,c+1,u,1n,g+1,l+1,t+1,1m+1,5+3,9,l+1,u,21,8+2,2,2j,3+6,d+7,2r,3+8,c+5,23+1,s,2,2,1k+d,2+4,2+1,6+a,2+z,a,2v+3,2+5,2+1,3+1,q+1,5+2,h+3,e,3+1,7,g,jk+2,qb+2,u+2,u+1,v+1,1t+1,2+6,9,3+a,a,1a+2,3c+1,z,3b+2,5+1,a,7+2,64+1,3,1n,2+6,2,2,3+7,7+9,3,1d+g,1s+3,1d,2+4,2,6,15+8,d+1,x+3,3+1,2+2,1l,2+1,4,2+2,1n+7,3+1,49+2,2+c,2+6,5,7,4+1,5j+1l,2+4,k1+w,2db+2,3y,2p+v,ff+3,30+1,n9x+3,2+9,x+1,29+1,7l,4,5,q+1,6,48+1,r+h,e,13+7,q+a,1b+2,1d,3+3,3+1,14,1w+5,3+1,3+1,d,9,1c,1g,2+2,3+1,6+1,2,17+1,9,6n,3,5,fn5,ki+f,h+f,r2,6b,46+4,1af+2,2+1,6+3,15+2,5,4m+1,fy+3,as+1,4a+a,4x,1j+e,1l+2,1e+3,3+1,1y+2,11+4,2+7,1r,d+1,1h+8,b+3,3,2o+2,3,2+1,7,4h,4+7,m+1,1m+1,4,12+6,4+4,5g+7,3+2,2,o,2d+5,2,5+1,2+1,6n+3,7+1,2+1,s+1,2e+7,3,2+1,2z,2,3+5,2,2u+2,3+3,2+4,78+8,2+1,75+1,2,5,41+3,3+1,5,x+5,3+1,15+5,3+3,9,a+5,3+2,1b+c,2+1,bb+6,2+5,2d+l,3+6,2+1,2+1,3f+5,4,2+1,2+6,2,21+1,4,2,9o+1,f0c+4,1o+6,t5,1s+3,2a,f5l+1,43t+2,i+7,3+6,v+3,45+2,1j0+1i,5+1d,9,f,n+4,2+e,11t+6,2+g,3+6,2+1,2+4,7a+6,c6+3,15t+6,32+6,gzhy+6n",AL:"16w,3,2,e+1b,z+2,2+2s,g+1,8+1,b+m,2+t,s+2i,c+e,4h+f,1d+1e,1bwe+dp,3+3z,x+c,2+1,35+3y,2rm+z,5+7,b+5,dt+l,c+u,17nl+27,1t+27,4x+6n,3+d",LRO:"6ct",RLO:"6cu",LRE:"6cq",RLE:"6cr",PDF:"6cs",LRI:"6ee",RLI:"6ef",FSI:"6eg",PDI:"6eh"},h={},t={};h.L=1,t[1]="L",Object.keys(d).forEach(function(j,oe){h[j]=1<<oe+1,t[h[j]]=j}),Object.freeze(h);var e=h.LRI|h.RLI|h.FSI,a=h.L|h.R|h.AL,o=h.B|h.S|h.WS|h.ON|h.FSI|h.LRI|h.RLI|h.PDI,r=h.BN|h.RLE|h.LRE|h.RLO|h.LRO|h.PDF,i=h.S|h.WS|h.B|e|h.PDI|r,s=null;function l(){if(!s){s=new Map;var j=function(Y){if(d.hasOwnProperty(Y)){var B=0;d[Y].split(",").forEach(function(pe){var q=pe.split("+"),ee=q[0],K=q[1];ee=parseInt(ee,36),K=K?parseInt(K,36):0,s.set(B+=ee,h[Y]);for(var te=0;te<K;te++)s.set(++B,h[Y])})}};for(var oe in d)j(oe)}}function u(j){return l(),s.get(j.codePointAt(0))||h.L}function f(j){return t[u(j)]}var p={pairs:"14>1,1e>2,u>2,2wt>1,1>1,1ge>1,1wp>1,1j>1,f>1,hm>1,1>1,u>1,u6>1,1>1,+5,28>1,w>1,1>1,+3,b8>1,1>1,+3,1>3,-1>-1,3>1,1>1,+2,1s>1,1>1,x>1,th>1,1>1,+2,db>1,1>1,+3,3>1,1>1,+2,14qm>1,1>1,+1,4q>1,1e>2,u>2,2>1,+1",canonical:"6f1>-6dx,6dy>-6dx,6ec>-6ed,6ee>-6ed,6ww>2jj,-2ji>2jj,14r4>-1e7l,1e7m>-1e7l,1e7m>-1e5c,1e5d>-1e5b,1e5c>-14qx,14qy>-14qx,14vn>-1ecg,1ech>-1ecg,1edu>-1ecg,1eci>-1ecg,1eda>-1ecg,1eci>-1ecg,1eci>-168q,168r>-168q,168s>-14ye,14yf>-14ye"};function m(j,oe){var Y=36,B=0,pe=new Map,q=oe&&new Map,ee;return j.split(",").forEach(function K(te){if(te.indexOf("+")!==-1)for(var ge=+te;ge--;)K(ee);else{ee=te;var Z=te.split(">"),ce=Z[0],Ue=Z[1];ce=String.fromCodePoint(B+=parseInt(ce,Y)),Ue=String.fromCodePoint(B+=parseInt(Ue,Y)),pe.set(ce,Ue),oe&&q.set(Ue,ce)}}),{map:pe,reverseMap:q}}var y,O,F;function C(){if(!y){var j=m(p.pairs,!0),oe=j.map,Y=j.reverseMap;y=oe,O=Y,F=m(p.canonical,!1).map}}function x(j){return C(),y.get(j)||null}function k(j){return C(),O.get(j)||null}function A(j){return C(),F.get(j)||null}var S=h.L,_=h.R,G=h.EN,W=h.ES,$=h.ET,g=h.AN,E=h.CS,D=h.B,V=h.S,N=h.ON,re=h.BN,se=h.NSM,R=h.AL,I=h.LRO,v=h.RLO,b=h.LRE,w=h.RLE,T=h.PDF,U=h.LRI,P=h.RLI,M=h.FSI,L=h.PDI;function H(j,oe){for(var Y=125,B=new Uint32Array(j.length),pe=0;pe<j.length;pe++)B[pe]=u(j[pe]);var q=new Map;function ee(Ie,Pe){var Re=B[Ie];B[Ie]=Pe,q.set(Re,q.get(Re)-1),Re&o&&q.set(o,q.get(o)-1),q.set(Pe,(q.get(Pe)||0)+1),Pe&o&&q.set(o,(q.get(o)||0)+1)}for(var K=new Uint8Array(j.length),te=new Map,ge=[],Z=null,ce=0;ce<j.length;ce++)Z||ge.push(Z={start:ce,end:j.length-1,level:oe==="rtl"?1:oe==="ltr"?0:jn(ce,!1)}),B[ce]&D&&(Z.end=ce,Z=null);for(var Ue=w|b|v|I|e|L|T|D,_e=function(Ie){return Ie+(Ie&1?1:2)},ye=function(Ie){return Ie+(Ie&1?2:1)},Fe=0;Fe<ge.length;Fe++){Z=ge[Fe];var ie=[{_level:Z.level,_override:0,_isolate:0}],me=void 0,we=0,ke=0,Ae=0;q.clear();for(var ue=Z.start;ue<=Z.end;ue++){var de=B[ue];if(me=ie[ie.length-1],q.set(de,(q.get(de)||0)+1),de&o&&q.set(o,(q.get(o)||0)+1),de&Ue)if(de&(w|b)){K[ue]=me._level;var Ve=(de===w?ye:_e)(me._level);Ve<=Y&&!we&&!ke?ie.push({_level:Ve,_override:0,_isolate:0}):we||ke++}else if(de&(v|I)){K[ue]=me._level;var xe=(de===v?ye:_e)(me._level);xe<=Y&&!we&&!ke?ie.push({_level:xe,_override:de&v?_:S,_isolate:0}):we||ke++}else if(de&e){de&M&&(de=jn(ue+1,!0)===1?P:U),K[ue]=me._level,me._override&&ee(ue,me._override);var be=(de===P?ye:_e)(me._level);be<=Y&&we===0&&ke===0?(Ae++,ie.push({_level:be,_override:0,_isolate:1,_isolInitIndex:ue})):we++}else if(de&L){if(we>0)we--;else if(Ae>0){for(ke=0;!ie[ie.length-1]._isolate;)ie.pop();var De=ie[ie.length-1]._isolInitIndex;De!=null&&(te.set(De,ue),te.set(ue,De)),ie.pop(),Ae--}me=ie[ie.length-1],K[ue]=me._level,me._override&&ee(ue,me._override)}else de&T?(we===0&&(ke>0?ke--:!me._isolate&&ie.length>1&&(ie.pop(),me=ie[ie.length-1])),K[ue]=me._level):de&D&&(K[ue]=Z.level);else K[ue]=me._level,me._override&&de!==re&&ee(ue,me._override)}for(var Te=[],ve=null,Se=Z.start;Se<=Z.end;Se++){var Me=B[Se];if(!(Me&r)){var Oe=K[Se],Ce=Me&e,We=Me===L;ve&&Oe===ve._level?(ve._end=Se,ve._endsWithIsolInit=Ce):Te.push(ve={_start:Se,_end:Se,_level:Oe,_startsWithPDI:We,_endsWithIsolInit:Ce})}}for(var qe=[],Ne=0;Ne<Te.length;Ne++){var Xe=Te[Ne];if(!Xe._startsWithPDI||Xe._startsWithPDI&&!te.has(Xe._start)){for(var $e=[ve=Xe],Ze=void 0;ve&&ve._endsWithIsolInit&&(Ze=te.get(ve._end))!=null;)for(var Ge=Ne+1;Ge<Te.length;Ge++)if(Te[Ge]._start===Ze){$e.push(ve=Te[Ge]);break}for(var je=[],Pt=0;Pt<$e.length;Pt++)for(var xn=$e[Pt],jt=xn._start;jt<=xn._end;jt++)je.push(jt);for(var br=K[je[0]],Sn=Z.level,bt=je[0]-1;bt>=0;bt--)if(!(B[bt]&r)){Sn=K[bt];break}var zt=je[je.length-1],xr=K[zt],Un=Z.level;if(!(B[zt]&e)){for(var xt=zt+1;xt<=Z.end;xt++)if(!(B[xt]&r)){Un=K[xt];break}}qe.push({_seqIndices:je,_sosType:Math.max(Sn,br)%2?_:S,_eosType:Math.max(Un,xr)%2?_:S})}}for(var Wt=0;Wt<qe.length;Wt++){var Nt=qe[Wt],ae=Nt._seqIndices,it=Nt._sosType,Sr=Nt._eosType,et=K[ae[0]]&1?_:S;if(q.get(se))for(var St=0;St<ae.length;St++){var kn=ae[St];if(B[kn]&se){for(var Xt=it,Ut=St-1;Ut>=0;Ut--)if(!(B[ae[Ut]]&r)){Xt=B[ae[Ut]];break}ee(kn,Xt&(e|L)?N:Xt)}}if(q.get(G))for(var kt=0;kt<ae.length;kt++){var _n=ae[kt];if(B[_n]&G)for(var _t=kt-1;_t>=-1;_t--){var wn=_t===-1?it:B[ae[_t]];if(wn&a){wn===R&&ee(_n,g);break}}}if(q.get(R))for(var Vt=0;Vt<ae.length;Vt++){var Tn=ae[Vt];B[Tn]&R&&ee(Tn,_)}if(q.get(W)||q.get(E))for(var st=1;st<ae.length-1;st++){var $t=ae[st];if(B[$t]&(W|E)){for(var tt=0,Ht=0,Yt=st-1;Yt>=0&&(tt=B[ae[Yt]],!!(tt&r));Yt--);for(var qt=st+1;qt<ae.length&&(Ht=B[ae[qt]],!!(Ht&r));qt++);tt===Ht&&(B[$t]===W?tt===G:tt&(G|g))&&ee($t,tt)}}if(q.get(G))for(var ze=0;ze<ae.length;ze++){var Ur=ae[ze];if(B[Ur]&G){for(var wt=ze-1;wt>=0&&B[ae[wt]]&($|r);wt--)ee(ae[wt],G);for(ze++;ze<ae.length&&B[ae[ze]]&($|r|G);ze++)B[ae[ze]]!==G&&ee(ae[ze],G)}}if(q.get($)||q.get(W)||q.get(E))for(var lt=0;lt<ae.length;lt++){var Cn=ae[lt];if(B[Cn]&($|W|E)){ee(Cn,N);for(var Tt=lt-1;Tt>=0&&B[ae[Tt]]&r;Tt--)ee(ae[Tt],N);for(var Ct=lt+1;Ct<ae.length&&B[ae[Ct]]&r;Ct++)ee(ae[Ct],N)}}if(q.get(G))for(var Zt=0,Fn=it;Zt<ae.length;Zt++){var Dn=ae[Zt],Qt=B[Dn];Qt&G?Fn===S&&ee(Dn,S):Qt&a&&(Fn=Qt)}if(q.get(o)){var ut=_|G|g,En=ut|S,Ft=[];{for(var nt=[],rt=0;rt<ae.length;rt++)if(B[ae[rt]]&o){var ft=j[ae[rt]],Mn=void 0;if(x(ft)!==null)if(nt.length<63)nt.push({char:ft,seqIndex:rt});else break;else if((Mn=k(ft))!==null)for(var ht=nt.length-1;ht>=0;ht--){var Kt=nt[ht].char;if(Kt===Mn||Kt===k(A(ft))||x(A(Kt))===ft){Ft.push([nt[ht].seqIndex,rt]),nt.length=ht;break}}}Ft.sort(function(Ie,Pe){return Ie[0]-Pe[0]})}for(var Jt=0;Jt<Ft.length;Jt++){for(var On=Ft[Jt],Dt=On[0],en=On[1],An=!1,Le=0,tn=Dt+1;tn<en;tn++){var In=ae[tn];if(B[In]&En){An=!0;var Rn=B[In]&ut?_:S;if(Rn===et){Le=Rn;break}}}if(An&&!Le){Le=it;for(var nn=Dt-1;nn>=0;nn--){var Gn=ae[nn];if(B[Gn]&En){var Bn=B[Gn]&ut?_:S;Bn!==et?Le=Bn:Le=et;break}}}if(Le){if(B[ae[Dt]]=B[ae[en]]=Le,Le!==et){for(var ct=Dt+1;ct<ae.length;ct++)if(!(B[ae[ct]]&r)){u(j[ae[ct]])&se&&(B[ae[ct]]=Le);break}}if(Le!==et){for(var dt=en+1;dt<ae.length;dt++)if(!(B[ae[dt]]&r)){u(j[ae[dt]])&se&&(B[ae[dt]]=Le);break}}}}for(var He=0;He<ae.length;He++)if(B[ae[He]]&o){for(var Ln=He,rn=He,an=it,vt=He-1;vt>=0;vt--)if(B[ae[vt]]&r)Ln=vt;else{an=B[ae[vt]]&ut?_:S;break}for(var Pn=Sr,pt=He+1;pt<ae.length;pt++)if(B[ae[pt]]&(o|r))rn=pt;else{Pn=B[ae[pt]]&ut?_:S;break}for(var on=Ln;on<=rn;on++)B[ae[on]]=an===Pn?an:et;He=rn}}}for(var Be=Z.start;Be<=Z.end;Be++){var kr=K[Be],Et=B[Be];if(kr&1?Et&(S|G|g)&&K[Be]++:Et&_?K[Be]++:Et&(g|G)&&(K[Be]+=2),Et&r&&(K[Be]=Be===0?Z.level:K[Be-1]),Be===Z.end||u(j[Be])&(V|D))for(var Mt=Be;Mt>=0&&u(j[Mt])&i;Mt--)K[Mt]=Z.level}}return{levels:K,paragraphs:ge};function jn(Ie,Pe){for(var Re=Ie;Re<j.length;Re++){var Ye=B[Re];if(Ye&(_|R))return 1;if(Ye&(D|S)||Pe&&Ye===L)return 0;if(Ye&e){var zn=_r(Re);Re=zn===-1?j.length:zn}}return 0}function _r(Ie){for(var Pe=1,Re=Ie+1;Re<j.length;Re++){var Ye=B[Re];if(Ye&D)break;if(Ye&L){if(--Pe===0)return Re}else Ye&e&&Pe++}return-1}}var Q="14>1,j>2,t>2,u>2,1a>g,2v3>1,1>1,1ge>1,1wd>1,b>1,1j>1,f>1,ai>3,-2>3,+1,8>1k0,-1jq>1y7,-1y6>1hf,-1he>1h6,-1h5>1ha,-1h8>1qi,-1pu>1,6>3u,-3s>7,6>1,1>1,f>1,1>1,+2,3>1,1>1,+13,4>1,1>1,6>1eo,-1ee>1,3>1mg,-1me>1mk,-1mj>1mi,-1mg>1mi,-1md>1,1>1,+2,1>10k,-103>1,1>1,4>1,5>1,1>1,+10,3>1,1>8,-7>8,+1,-6>7,+1,a>1,1>1,u>1,u6>1,1>1,+5,26>1,1>1,2>1,2>2,8>1,7>1,4>1,1>1,+5,b8>1,1>1,+3,1>3,-2>1,2>1,1>1,+2,c>1,3>1,1>1,+2,h>1,3>1,a>1,1>1,2>1,3>1,1>1,d>1,f>1,3>1,1a>1,1>1,6>1,7>1,13>1,k>1,1>1,+19,4>1,1>1,+2,2>1,1>1,+18,m>1,a>1,1>1,lk>1,1>1,4>1,2>1,f>1,3>1,1>1,+3,db>1,1>1,+3,3>1,1>1,+2,14qm>1,1>1,+1,6>1,4j>1,j>2,t>2,u>2,2>1,+1",X;function z(){if(!X){var j=m(Q,!0),oe=j.map,Y=j.reverseMap;Y.forEach(function(B,pe){oe.set(pe,B)}),X=oe}}function fe(j){return z(),X.get(j)||null}function he(j,oe,Y,B){var pe=j.length;Y=Math.max(0,Y==null?0:+Y),B=Math.min(pe-1,B==null?pe-1:+B);for(var q=new Map,ee=Y;ee<=B;ee++)if(oe[ee]&1){var K=fe(j[ee]);K!==null&&q.set(ee,K)}return q}function ne(j,oe,Y,B){var pe=j.length;Y=Math.max(0,Y==null?0:+Y),B=Math.min(pe-1,B==null?pe-1:+B);var q=[];return oe.paragraphs.forEach(function(ee){var K=Math.max(Y,ee.start),te=Math.min(B,ee.end);if(K<te){for(var ge=oe.levels.slice(K,te+1),Z=te;Z>=K&&u(j[Z])&i;Z--)ge[Z]=ee.level;for(var ce=ee.level,Ue=1/0,_e=0;_e<ge.length;_e++){var ye=ge[_e];ye>ce&&(ce=ye),ye<Ue&&(Ue=ye|1)}for(var Fe=ce;Fe>=Ue;Fe--)for(var ie=0;ie<ge.length;ie++)if(ge[ie]>=Fe){for(var me=ie;ie+1<ge.length&&ge[ie+1]>=Fe;)ie++;ie>me&&q.push([me+K,ie+K])}}}),q}function J(j,oe,Y,B){var pe=le(j,oe,Y,B),q=[].concat(j);return pe.forEach(function(ee,K){q[K]=(oe.levels[ee]&1?fe(j[ee]):null)||j[ee]}),q.join("")}function le(j,oe,Y,B){for(var pe=ne(j,oe,Y,B),q=[],ee=0;ee<j.length;ee++)q[ee]=ee;return pe.forEach(function(K){for(var te=K[0],ge=K[1],Z=q.slice(te,ge+1),ce=Z.length;ce--;)q[ge-ce]=Z[ce]}),q}return n.closingToOpeningBracket=k,n.getBidiCharType=u,n.getBidiCharTypeName=f,n.getCanonicalBracket=A,n.getEmbeddingLevels=H,n.getMirroredCharacter=fe,n.getMirroredCharactersMap=he,n.getReorderSegments=ne,n.getReorderedIndices=le,n.getReorderedString=J,n.openingToClosingBracket=x,Object.defineProperty(n,"__esModule",{value:!0}),n})({});return c}const ur=/\bvoid\s+main\s*\(\s*\)\s*{/g;function cn(c){const n=/^[ \t]*#include +<([\w\d./]+)>/gm;function d(h,t){let e=zr[t];return e?cn(e):h}return c.replace(n,d)}const Ee=[];for(let c=0;c<256;c++)Ee[c]=(c<16?"0":"")+c.toString(16);function qr(){const c=Math.random()*4294967295|0,n=Math.random()*4294967295|0,d=Math.random()*4294967295|0,h=Math.random()*4294967295|0;return(Ee[c&255]+Ee[c>>8&255]+Ee[c>>16&255]+Ee[c>>24&255]+"-"+Ee[n&255]+Ee[n>>8&255]+"-"+Ee[n>>16&15|64]+Ee[n>>24&255]+"-"+Ee[d&63|128]+Ee[d>>8&255]+"-"+Ee[d>>16&255]+Ee[d>>24&255]+Ee[h&255]+Ee[h>>8&255]+Ee[h>>16&255]+Ee[h>>24&255]).toUpperCase()}const Qe=Object.assign||function(){let c=arguments[0];for(let n=1,d=arguments.length;n<d;n++){let h=arguments[n];if(h)for(let t in h)Object.prototype.hasOwnProperty.call(h,t)&&(c[t]=h[t])}return c},Zr=Date.now(),Vn=new WeakMap,$n=new Map;let Qr=1e10;function dn(c,n){const d=ta(n);let h=Vn.get(c);if(h||Vn.set(c,h=Object.create(null)),h[d])return new h[d];const t=`_onBeforeCompile${d}`,e=function(i,s){c.onBeforeCompile.call(this,i,s);const l=this.customProgramCacheKey()+"|"+i.vertexShader+"|"+i.fragmentShader;let u=$n[l];if(!u){const f=Kr(this,i,n,d);u=$n[l]=f}i.vertexShader=u.vertexShader,i.fragmentShader=u.fragmentShader,Qe(i.uniforms,this.uniforms),n.timeUniform&&(i.uniforms[n.timeUniform]={get value(){return Date.now()-Zr}}),this[t]&&this[t](i)},a=function(){return o(n.chained?c:c.clone())},o=function(i){const s=Object.create(i,r);return Object.defineProperty(s,"baseMaterial",{value:c}),Object.defineProperty(s,"id",{value:Qr++}),s.uuid=qr(),s.uniforms=Qe({},i.uniforms,n.uniforms),s.defines=Qe({},i.defines,n.defines),s.defines[`TROIKA_DERIVED_MATERIAL_${d}`]="",s.extensions=Qe({},i.extensions,n.extensions),s._listeners=void 0,s},r={constructor:{value:a},isDerivedMaterial:{value:!0},customProgramCacheKey:{writable:!0,configurable:!0,value:function(){return c.customProgramCacheKey()+"|"+d}},onBeforeCompile:{get(){return e},set(i){this[t]=i}},copy:{writable:!0,configurable:!0,value:function(i){return c.copy.call(this,i),!c.isShaderMaterial&&!c.isDerivedMaterial&&(Qe(this.extensions,i.extensions),Qe(this.defines,i.defines),Qe(this.uniforms,jr.clone(i.uniforms))),this}},clone:{writable:!0,configurable:!0,value:function(){const i=new c.constructor;return o(i).copy(this)}},getDepthMaterial:{writable:!0,configurable:!0,value:function(){let i=this._depthMaterial;return i||(i=this._depthMaterial=dn(c.isDerivedMaterial?c.getDepthMaterial():new Lr({depthPacking:Pr}),n),i.defines.IS_DEPTH_MATERIAL="",i.uniforms=this.uniforms),i}},getDistanceMaterial:{writable:!0,configurable:!0,value:function(){let i=this._distanceMaterial;return i||(i=this._distanceMaterial=dn(c.isDerivedMaterial?c.getDistanceMaterial():new Br,n),i.defines.IS_DISTANCE_MATERIAL="",i.uniforms=this.uniforms),i}},dispose:{writable:!0,configurable:!0,value(){const{_depthMaterial:i,_distanceMaterial:s}=this;i&&i.dispose(),s&&s.dispose(),c.dispose.call(this)}}};return h[d]=a,new a}function Kr(c,{vertexShader:n,fragmentShader:d},h,t){let{vertexDefs:e,vertexMainIntro:a,vertexMainOutro:o,vertexTransform:r,fragmentDefs:i,fragmentMainIntro:s,fragmentMainOutro:l,fragmentColorTransform:u,customRewriter:f,timeUniform:p}=h;if(e=e||"",a=a||"",o=o||"",i=i||"",s=s||"",l=l||"",(r||f)&&(n=cn(n)),(u||f)&&(d=d.replace(/^[ \t]*#include <((?:tonemapping|encodings|fog|premultiplied_alpha|dithering)_fragment)>/gm,`
//!BEGIN_POST_CHUNK $1
$&
//!END_POST_CHUNK
`),d=cn(d)),f){let m=f({vertexShader:n,fragmentShader:d});n=m.vertexShader,d=m.fragmentShader}if(u){let m=[];d=d.replace(/^\/\/!BEGIN_POST_CHUNK[^]+?^\/\/!END_POST_CHUNK/gm,y=>(m.push(y),"")),l=`${u}
${m.join(`
`)}
${l}`}if(p){const m=`
uniform float ${p};
`;e=m+e,i=m+i}return r&&(n=`vec3 troika_position_${t};
vec3 troika_normal_${t};
vec2 troika_uv_${t};
${n}
`,e=`${e}
void troikaVertexTransform${t}(inout vec3 position, inout vec3 normal, inout vec2 uv) {
  ${r}
}
`,a=`
troika_position_${t} = vec3(position);
troika_normal_${t} = vec3(normal);
troika_uv_${t} = vec2(uv);
troikaVertexTransform${t}(troika_position_${t}, troika_normal_${t}, troika_uv_${t});
${a}
`,n=n.replace(/\b(position|normal|uv)\b/g,(m,y,O,F)=>/\battribute\s+vec[23]\s+$/.test(F.substr(0,O))?y:`troika_${y}_${t}`),c.map&&c.map.channel>0||(n=n.replace(/\bMAP_UV\b/g,`troika_uv_${t}`))),n=Hn(n,t,e,a,o),d=Hn(d,t,i,s,l),{vertexShader:n,fragmentShader:d}}function Hn(c,n,d,h,t){return(h||t||d)&&(c=c.replace(ur,`
${d}
void troikaOrigMain${n}() {`),c+=`
void main() {
  ${h}
  troikaOrigMain${n}();
  ${t}
}`),c}function Jr(c,n){return c==="uniforms"?void 0:typeof n=="function"?n.toString():n}let ea=0;const Yn=new Map;function ta(c){const n=JSON.stringify(c,Jr);let d=Yn.get(n);return d==null&&Yn.set(n,d=++ea),d}/*!
Custom build of Typr.ts (https://github.com/fredli74/Typr.ts) for use in Troika text rendering.
Original MIT license applies: https://github.com/fredli74/Typr.ts/blob/master/LICENSE
*/function na(){return typeof window>"u"&&(self.window=self),(function(c){var n={parse:function(t){var e=n._bin,a=new Uint8Array(t);if(e.readASCII(a,0,4)=="ttcf"){var o=4;e.readUshort(a,o),o+=2,e.readUshort(a,o),o+=2;var r=e.readUint(a,o);o+=4;for(var i=[],s=0;s<r;s++){var l=e.readUint(a,o);o+=4,i.push(n._readFont(a,l))}return i}return[n._readFont(a,0)]},_readFont:function(t,e){var a=n._bin,o=e;a.readFixed(t,e),e+=4;var r=a.readUshort(t,e);e+=2,a.readUshort(t,e),e+=2,a.readUshort(t,e),e+=2,a.readUshort(t,e),e+=2;for(var i=["cmap","head","hhea","maxp","hmtx","name","OS/2","post","loca","glyf","kern","CFF ","GDEF","GPOS","GSUB","SVG "],s={_data:t,_offset:o},l={},u=0;u<r;u++){var f=a.readASCII(t,e,4);e+=4,a.readUint(t,e),e+=4;var p=a.readUint(t,e);e+=4;var m=a.readUint(t,e);e+=4,l[f]={offset:p,length:m}}for(u=0;u<i.length;u++){var y=i[u];l[y]&&(s[y.trim()]=n[y.trim()].parse(t,l[y].offset,l[y].length,s))}return s},_tabOffset:function(t,e,a){for(var o=n._bin,r=o.readUshort(t,a+4),i=a+12,s=0;s<r;s++){var l=o.readASCII(t,i,4);i+=4,o.readUint(t,i),i+=4;var u=o.readUint(t,i);if(i+=4,o.readUint(t,i),i+=4,l==e)return u}return 0}};n._bin={readFixed:function(t,e){return(t[e]<<8|t[e+1])+(t[e+2]<<8|t[e+3])/65540},readF2dot14:function(t,e){return n._bin.readShort(t,e)/16384},readInt:function(t,e){return n._bin._view(t).getInt32(e)},readInt8:function(t,e){return n._bin._view(t).getInt8(e)},readShort:function(t,e){return n._bin._view(t).getInt16(e)},readUshort:function(t,e){return n._bin._view(t).getUint16(e)},readUshorts:function(t,e,a){for(var o=[],r=0;r<a;r++)o.push(n._bin.readUshort(t,e+2*r));return o},readUint:function(t,e){return n._bin._view(t).getUint32(e)},readUint64:function(t,e){return 4294967296*n._bin.readUint(t,e)+n._bin.readUint(t,e+4)},readASCII:function(t,e,a){for(var o="",r=0;r<a;r++)o+=String.fromCharCode(t[e+r]);return o},readUnicode:function(t,e,a){for(var o="",r=0;r<a;r++){var i=t[e++]<<8|t[e++];o+=String.fromCharCode(i)}return o},_tdec:typeof window<"u"&&window.TextDecoder?new window.TextDecoder:null,readUTF8:function(t,e,a){var o=n._bin._tdec;return o&&e==0&&a==t.length?o.decode(t):n._bin.readASCII(t,e,a)},readBytes:function(t,e,a){for(var o=[],r=0;r<a;r++)o.push(t[e+r]);return o},readASCIIArray:function(t,e,a){for(var o=[],r=0;r<a;r++)o.push(String.fromCharCode(t[e+r]));return o},_view:function(t){return t._dataView||(t._dataView=t.buffer?new DataView(t.buffer,t.byteOffset,t.byteLength):new DataView(new Uint8Array(t).buffer))}},n._lctf={},n._lctf.parse=function(t,e,a,o,r){var i=n._bin,s={},l=e;i.readFixed(t,e),e+=4;var u=i.readUshort(t,e);e+=2;var f=i.readUshort(t,e);e+=2;var p=i.readUshort(t,e);return e+=2,s.scriptList=n._lctf.readScriptList(t,l+u),s.featureList=n._lctf.readFeatureList(t,l+f),s.lookupList=n._lctf.readLookupList(t,l+p,r),s},n._lctf.readLookupList=function(t,e,a){var o=n._bin,r=e,i=[],s=o.readUshort(t,e);e+=2;for(var l=0;l<s;l++){var u=o.readUshort(t,e);e+=2;var f=n._lctf.readLookupTable(t,r+u,a);i.push(f)}return i},n._lctf.readLookupTable=function(t,e,a){var o=n._bin,r=e,i={tabs:[]};i.ltype=o.readUshort(t,e),e+=2,i.flag=o.readUshort(t,e),e+=2;var s=o.readUshort(t,e);e+=2;for(var l=i.ltype,u=0;u<s;u++){var f=o.readUshort(t,e);e+=2;var p=a(t,l,r+f,i);i.tabs.push(p)}return i},n._lctf.numOfOnes=function(t){for(var e=0,a=0;a<32;a++)(t>>>a&1)!=0&&e++;return e},n._lctf.readClassDef=function(t,e){var a=n._bin,o=[],r=a.readUshort(t,e);if(e+=2,r==1){var i=a.readUshort(t,e);e+=2;var s=a.readUshort(t,e);e+=2;for(var l=0;l<s;l++)o.push(i+l),o.push(i+l),o.push(a.readUshort(t,e)),e+=2}if(r==2){var u=a.readUshort(t,e);for(e+=2,l=0;l<u;l++)o.push(a.readUshort(t,e)),e+=2,o.push(a.readUshort(t,e)),e+=2,o.push(a.readUshort(t,e)),e+=2}return o},n._lctf.getInterval=function(t,e){for(var a=0;a<t.length;a+=3){var o=t[a],r=t[a+1];if(t[a+2],o<=e&&e<=r)return a}return-1},n._lctf.readCoverage=function(t,e){var a=n._bin,o={};o.fmt=a.readUshort(t,e),e+=2;var r=a.readUshort(t,e);return e+=2,o.fmt==1&&(o.tab=a.readUshorts(t,e,r)),o.fmt==2&&(o.tab=a.readUshorts(t,e,3*r)),o},n._lctf.coverageIndex=function(t,e){var a=t.tab;if(t.fmt==1)return a.indexOf(e);if(t.fmt==2){var o=n._lctf.getInterval(a,e);if(o!=-1)return a[o+2]+(e-a[o])}return-1},n._lctf.readFeatureList=function(t,e){var a=n._bin,o=e,r=[],i=a.readUshort(t,e);e+=2;for(var s=0;s<i;s++){var l=a.readASCII(t,e,4);e+=4;var u=a.readUshort(t,e);e+=2;var f=n._lctf.readFeatureTable(t,o+u);f.tag=l.trim(),r.push(f)}return r},n._lctf.readFeatureTable=function(t,e){var a=n._bin,o=e,r={},i=a.readUshort(t,e);e+=2,i>0&&(r.featureParams=o+i);var s=a.readUshort(t,e);e+=2,r.tab=[];for(var l=0;l<s;l++)r.tab.push(a.readUshort(t,e+2*l));return r},n._lctf.readScriptList=function(t,e){var a=n._bin,o=e,r={},i=a.readUshort(t,e);e+=2;for(var s=0;s<i;s++){var l=a.readASCII(t,e,4);e+=4;var u=a.readUshort(t,e);e+=2,r[l.trim()]=n._lctf.readScriptTable(t,o+u)}return r},n._lctf.readScriptTable=function(t,e){var a=n._bin,o=e,r={},i=a.readUshort(t,e);e+=2,i>0&&(r.default=n._lctf.readLangSysTable(t,o+i));var s=a.readUshort(t,e);e+=2;for(var l=0;l<s;l++){var u=a.readASCII(t,e,4);e+=4;var f=a.readUshort(t,e);e+=2,r[u.trim()]=n._lctf.readLangSysTable(t,o+f)}return r},n._lctf.readLangSysTable=function(t,e){var a=n._bin,o={};a.readUshort(t,e),e+=2,o.reqFeature=a.readUshort(t,e),e+=2;var r=a.readUshort(t,e);return e+=2,o.features=a.readUshorts(t,e,r),o},n.CFF={},n.CFF.parse=function(t,e,a){var o=n._bin;(t=new Uint8Array(t.buffer,e,a))[e=0],t[++e],t[++e],t[++e],e++;var r=[];e=n.CFF.readIndex(t,e,r);for(var i=[],s=0;s<r.length-1;s++)i.push(o.readASCII(t,e+r[s],r[s+1]-r[s]));e+=r[r.length-1];var l=[];e=n.CFF.readIndex(t,e,l);var u=[];for(s=0;s<l.length-1;s++)u.push(n.CFF.readDict(t,e+l[s],e+l[s+1]));e+=l[l.length-1];var f=u[0],p=[];e=n.CFF.readIndex(t,e,p);var m=[];for(s=0;s<p.length-1;s++)m.push(o.readASCII(t,e+p[s],p[s+1]-p[s]));if(e+=p[p.length-1],n.CFF.readSubrs(t,e,f),f.CharStrings){e=f.CharStrings,p=[],e=n.CFF.readIndex(t,e,p);var y=[];for(s=0;s<p.length-1;s++)y.push(o.readBytes(t,e+p[s],p[s+1]-p[s]));f.CharStrings=y}if(f.ROS){e=f.FDArray;var O=[];for(e=n.CFF.readIndex(t,e,O),f.FDArray=[],s=0;s<O.length-1;s++){var F=n.CFF.readDict(t,e+O[s],e+O[s+1]);n.CFF._readFDict(t,F,m),f.FDArray.push(F)}e+=O[O.length-1],e=f.FDSelect,f.FDSelect=[];var C=t[e];if(e++,C!=3)throw C;var x=o.readUshort(t,e);for(e+=2,s=0;s<x+1;s++)f.FDSelect.push(o.readUshort(t,e),t[e+2]),e+=3}return f.Encoding&&(f.Encoding=n.CFF.readEncoding(t,f.Encoding,f.CharStrings.length)),f.charset&&(f.charset=n.CFF.readCharset(t,f.charset,f.CharStrings.length)),n.CFF._readFDict(t,f,m),f},n.CFF._readFDict=function(t,e,a){var o;for(var r in e.Private&&(o=e.Private[1],e.Private=n.CFF.readDict(t,o,o+e.Private[0]),e.Private.Subrs&&n.CFF.readSubrs(t,o+e.Private.Subrs,e.Private)),e)["FamilyName","FontName","FullName","Notice","version","Copyright"].indexOf(r)!=-1&&(e[r]=a[e[r]-426+35])},n.CFF.readSubrs=function(t,e,a){var o=n._bin,r=[];e=n.CFF.readIndex(t,e,r);var i,s=r.length;i=s<1240?107:s<33900?1131:32768,a.Bias=i,a.Subrs=[];for(var l=0;l<r.length-1;l++)a.Subrs.push(o.readBytes(t,e+r[l],r[l+1]-r[l]))},n.CFF.tableSE=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,0,111,112,113,114,0,115,116,117,118,119,120,121,122,0,123,0,124,125,126,127,128,129,130,131,0,132,133,0,134,135,136,137,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,138,0,139,0,0,0,0,140,141,142,143,0,0,0,0,0,144,0,0,0,145,0,0,146,147,148,149,0,0,0,0],n.CFF.glyphByUnicode=function(t,e){for(var a=0;a<t.charset.length;a++)if(t.charset[a]==e)return a;return-1},n.CFF.glyphBySE=function(t,e){return e<0||e>255?-1:n.CFF.glyphByUnicode(t,n.CFF.tableSE[e])},n.CFF.readEncoding=function(t,e,a){n._bin;var o=[".notdef"],r=t[e];if(e++,r!=0)throw"error: unknown encoding format: "+r;var i=t[e];e++;for(var s=0;s<i;s++)o.push(t[e+s]);return o},n.CFF.readCharset=function(t,e,a){var o=n._bin,r=[".notdef"],i=t[e];if(e++,i==0)for(var s=0;s<a;s++){var l=o.readUshort(t,e);e+=2,r.push(l)}else{if(i!=1&&i!=2)throw"error: format: "+i;for(;r.length<a;){l=o.readUshort(t,e),e+=2;var u=0;for(i==1?(u=t[e],e++):(u=o.readUshort(t,e),e+=2),s=0;s<=u;s++)r.push(l),l++}}return r},n.CFF.readIndex=function(t,e,a){var o=n._bin,r=o.readUshort(t,e)+1,i=t[e+=2];if(e++,i==1)for(var s=0;s<r;s++)a.push(t[e+s]);else if(i==2)for(s=0;s<r;s++)a.push(o.readUshort(t,e+2*s));else if(i==3)for(s=0;s<r;s++)a.push(16777215&o.readUint(t,e+3*s-1));else if(r!=1)throw"unsupported offset size: "+i+", count: "+r;return(e+=r*i)-1},n.CFF.getCharString=function(t,e,a){var o=n._bin,r=t[e],i=t[e+1];t[e+2],t[e+3],t[e+4];var s=1,l=null,u=null;r<=20&&(l=r,s=1),r==12&&(l=100*r+i,s=2),21<=r&&r<=27&&(l=r,s=1),r==28&&(u=o.readShort(t,e+1),s=3),29<=r&&r<=31&&(l=r,s=1),32<=r&&r<=246&&(u=r-139,s=1),247<=r&&r<=250&&(u=256*(r-247)+i+108,s=2),251<=r&&r<=254&&(u=256*-(r-251)-i-108,s=2),r==255&&(u=o.readInt(t,e+1)/65535,s=5),a.val=u??"o"+l,a.size=s},n.CFF.readCharString=function(t,e,a){for(var o=e+a,r=n._bin,i=[];e<o;){var s=t[e],l=t[e+1];t[e+2],t[e+3],t[e+4];var u=1,f=null,p=null;s<=20&&(f=s,u=1),s==12&&(f=100*s+l,u=2),s!=19&&s!=20||(f=s,u=2),21<=s&&s<=27&&(f=s,u=1),s==28&&(p=r.readShort(t,e+1),u=3),29<=s&&s<=31&&(f=s,u=1),32<=s&&s<=246&&(p=s-139,u=1),247<=s&&s<=250&&(p=256*(s-247)+l+108,u=2),251<=s&&s<=254&&(p=256*-(s-251)-l-108,u=2),s==255&&(p=r.readInt(t,e+1)/65535,u=5),i.push(p??"o"+f),e+=u}return i},n.CFF.readDict=function(t,e,a){for(var o=n._bin,r={},i=[];e<a;){var s=t[e],l=t[e+1];t[e+2],t[e+3],t[e+4];var u=1,f=null,p=null;if(s==28&&(p=o.readShort(t,e+1),u=3),s==29&&(p=o.readInt(t,e+1),u=5),32<=s&&s<=246&&(p=s-139,u=1),247<=s&&s<=250&&(p=256*(s-247)+l+108,u=2),251<=s&&s<=254&&(p=256*-(s-251)-l-108,u=2),s==255)throw p=o.readInt(t,e+1)/65535,u=5,"unknown number";if(s==30){var m=[];for(u=1;;){var y=t[e+u];u++;var O=y>>4,F=15&y;if(O!=15&&m.push(O),F!=15&&m.push(F),F==15)break}for(var C="",x=[0,1,2,3,4,5,6,7,8,9,".","e","e-","reserved","-","endOfNumber"],k=0;k<m.length;k++)C+=x[m[k]];p=parseFloat(C)}s<=21&&(f=["version","Notice","FullName","FamilyName","Weight","FontBBox","BlueValues","OtherBlues","FamilyBlues","FamilyOtherBlues","StdHW","StdVW","escape","UniqueID","XUID","charset","Encoding","CharStrings","Private","Subrs","defaultWidthX","nominalWidthX"][s],u=1,s==12&&(f=["Copyright","isFixedPitch","ItalicAngle","UnderlinePosition","UnderlineThickness","PaintType","CharstringType","FontMatrix","StrokeWidth","BlueScale","BlueShift","BlueFuzz","StemSnapH","StemSnapV","ForceBold",0,0,"LanguageGroup","ExpansionFactor","initialRandomSeed","SyntheticBase","PostScript","BaseFontName","BaseFontBlend",0,0,0,0,0,0,"ROS","CIDFontVersion","CIDFontRevision","CIDFontType","CIDCount","UIDBase","FDArray","FDSelect","FontName"][l],u=2)),f!=null?(r[f]=i.length==1?i[0]:i,i=[]):i.push(p),e+=u}return r},n.cmap={},n.cmap.parse=function(t,e,a){t=new Uint8Array(t.buffer,e,a),e=0;var o=n._bin,r={};o.readUshort(t,e),e+=2;var i=o.readUshort(t,e);e+=2;var s=[];r.tables=[];for(var l=0;l<i;l++){var u=o.readUshort(t,e);e+=2;var f=o.readUshort(t,e);e+=2;var p=o.readUint(t,e);e+=4;var m="p"+u+"e"+f,y=s.indexOf(p);if(y==-1){var O;y=r.tables.length,s.push(p);var F=o.readUshort(t,p);F==0?O=n.cmap.parse0(t,p):F==4?O=n.cmap.parse4(t,p):F==6?O=n.cmap.parse6(t,p):F==12?O=n.cmap.parse12(t,p):console.debug("unknown format: "+F,u,f,p),r.tables.push(O)}if(r[m]!=null)throw"multiple tables for one platform+encoding";r[m]=y}return r},n.cmap.parse0=function(t,e){var a=n._bin,o={};o.format=a.readUshort(t,e),e+=2;var r=a.readUshort(t,e);e+=2,a.readUshort(t,e),e+=2,o.map=[];for(var i=0;i<r-6;i++)o.map.push(t[e+i]);return o},n.cmap.parse4=function(t,e){var a=n._bin,o=e,r={};r.format=a.readUshort(t,e),e+=2;var i=a.readUshort(t,e);e+=2,a.readUshort(t,e),e+=2;var s=a.readUshort(t,e);e+=2;var l=s/2;r.searchRange=a.readUshort(t,e),e+=2,r.entrySelector=a.readUshort(t,e),e+=2,r.rangeShift=a.readUshort(t,e),e+=2,r.endCount=a.readUshorts(t,e,l),e+=2*l,e+=2,r.startCount=a.readUshorts(t,e,l),e+=2*l,r.idDelta=[];for(var u=0;u<l;u++)r.idDelta.push(a.readShort(t,e)),e+=2;for(r.idRangeOffset=a.readUshorts(t,e,l),e+=2*l,r.glyphIdArray=[];e<o+i;)r.glyphIdArray.push(a.readUshort(t,e)),e+=2;return r},n.cmap.parse6=function(t,e){var a=n._bin,o={};o.format=a.readUshort(t,e),e+=2,a.readUshort(t,e),e+=2,a.readUshort(t,e),e+=2,o.firstCode=a.readUshort(t,e),e+=2;var r=a.readUshort(t,e);e+=2,o.glyphIdArray=[];for(var i=0;i<r;i++)o.glyphIdArray.push(a.readUshort(t,e)),e+=2;return o},n.cmap.parse12=function(t,e){var a=n._bin,o={};o.format=a.readUshort(t,e),e+=2,e+=2,a.readUint(t,e),e+=4,a.readUint(t,e),e+=4;var r=a.readUint(t,e);e+=4,o.groups=[];for(var i=0;i<r;i++){var s=e+12*i,l=a.readUint(t,s+0),u=a.readUint(t,s+4),f=a.readUint(t,s+8);o.groups.push([l,u,f])}return o},n.glyf={},n.glyf.parse=function(t,e,a,o){for(var r=[],i=0;i<o.maxp.numGlyphs;i++)r.push(null);return r},n.glyf._parseGlyf=function(t,e){var a=n._bin,o=t._data,r=n._tabOffset(o,"glyf",t._offset)+t.loca[e];if(t.loca[e]==t.loca[e+1])return null;var i={};if(i.noc=a.readShort(o,r),r+=2,i.xMin=a.readShort(o,r),r+=2,i.yMin=a.readShort(o,r),r+=2,i.xMax=a.readShort(o,r),r+=2,i.yMax=a.readShort(o,r),r+=2,i.xMin>=i.xMax||i.yMin>=i.yMax)return null;if(i.noc>0){i.endPts=[];for(var s=0;s<i.noc;s++)i.endPts.push(a.readUshort(o,r)),r+=2;var l=a.readUshort(o,r);if(r+=2,o.length-r<l)return null;i.instructions=a.readBytes(o,r,l),r+=l;var u=i.endPts[i.noc-1]+1;for(i.flags=[],s=0;s<u;s++){var f=o[r];if(r++,i.flags.push(f),(8&f)!=0){var p=o[r];r++;for(var m=0;m<p;m++)i.flags.push(f),s++}}for(i.xs=[],s=0;s<u;s++){var y=(2&i.flags[s])!=0,O=(16&i.flags[s])!=0;y?(i.xs.push(O?o[r]:-o[r]),r++):O?i.xs.push(0):(i.xs.push(a.readShort(o,r)),r+=2)}for(i.ys=[],s=0;s<u;s++)y=(4&i.flags[s])!=0,O=(32&i.flags[s])!=0,y?(i.ys.push(O?o[r]:-o[r]),r++):O?i.ys.push(0):(i.ys.push(a.readShort(o,r)),r+=2);var F=0,C=0;for(s=0;s<u;s++)F+=i.xs[s],C+=i.ys[s],i.xs[s]=F,i.ys[s]=C}else{var x;i.parts=[];do{x=a.readUshort(o,r),r+=2;var k={m:{a:1,b:0,c:0,d:1,tx:0,ty:0},p1:-1,p2:-1};if(i.parts.push(k),k.glyphIndex=a.readUshort(o,r),r+=2,1&x){var A=a.readShort(o,r);r+=2;var S=a.readShort(o,r);r+=2}else A=a.readInt8(o,r),r++,S=a.readInt8(o,r),r++;2&x?(k.m.tx=A,k.m.ty=S):(k.p1=A,k.p2=S),8&x?(k.m.a=k.m.d=a.readF2dot14(o,r),r+=2):64&x?(k.m.a=a.readF2dot14(o,r),r+=2,k.m.d=a.readF2dot14(o,r),r+=2):128&x&&(k.m.a=a.readF2dot14(o,r),r+=2,k.m.b=a.readF2dot14(o,r),r+=2,k.m.c=a.readF2dot14(o,r),r+=2,k.m.d=a.readF2dot14(o,r),r+=2)}while(32&x);if(256&x){var _=a.readUshort(o,r);for(r+=2,i.instr=[],s=0;s<_;s++)i.instr.push(o[r]),r++}}return i},n.GDEF={},n.GDEF.parse=function(t,e,a,o){var r=e;e+=4;var i=n._bin.readUshort(t,e);return{glyphClassDef:i===0?null:n._lctf.readClassDef(t,r+i)}},n.GPOS={},n.GPOS.parse=function(t,e,a,o){return n._lctf.parse(t,e,a,o,n.GPOS.subt)},n.GPOS.subt=function(t,e,a,o){var r=n._bin,i=a,s={};if(s.fmt=r.readUshort(t,a),a+=2,e==1||e==2||e==3||e==7||e==8&&s.fmt<=2){var l=r.readUshort(t,a);a+=2,s.coverage=n._lctf.readCoverage(t,l+i)}if(e==1&&s.fmt==1){var u=r.readUshort(t,a);a+=2,u!=0&&(s.pos=n.GPOS.readValueRecord(t,a,u))}else if(e==2&&s.fmt>=1&&s.fmt<=2){u=r.readUshort(t,a),a+=2;var f=r.readUshort(t,a);a+=2;var p=n._lctf.numOfOnes(u),m=n._lctf.numOfOnes(f);if(s.fmt==1){s.pairsets=[];var y=r.readUshort(t,a);a+=2;for(var O=0;O<y;O++){var F=i+r.readUshort(t,a);a+=2;var C=r.readUshort(t,F);F+=2;for(var x=[],k=0;k<C;k++){var A=r.readUshort(t,F);F+=2,u!=0&&(g=n.GPOS.readValueRecord(t,F,u),F+=2*p),f!=0&&(E=n.GPOS.readValueRecord(t,F,f),F+=2*m),x.push({gid2:A,val1:g,val2:E})}s.pairsets.push(x)}}if(s.fmt==2){var S=r.readUshort(t,a);a+=2;var _=r.readUshort(t,a);a+=2;var G=r.readUshort(t,a);a+=2;var W=r.readUshort(t,a);for(a+=2,s.classDef1=n._lctf.readClassDef(t,i+S),s.classDef2=n._lctf.readClassDef(t,i+_),s.matrix=[],O=0;O<G;O++){var $=[];for(k=0;k<W;k++){var g=null,E=null;u!=0&&(g=n.GPOS.readValueRecord(t,a,u),a+=2*p),f!=0&&(E=n.GPOS.readValueRecord(t,a,f),a+=2*m),$.push({val1:g,val2:E})}s.matrix.push($)}}}else if(e==4&&s.fmt==1)s.markCoverage=n._lctf.readCoverage(t,r.readUshort(t,a)+i),s.baseCoverage=n._lctf.readCoverage(t,r.readUshort(t,a+2)+i),s.markClassCount=r.readUshort(t,a+4),s.markArray=n.GPOS.readMarkArray(t,r.readUshort(t,a+6)+i),s.baseArray=n.GPOS.readBaseArray(t,r.readUshort(t,a+8)+i,s.markClassCount);else if(e==6&&s.fmt==1)s.mark1Coverage=n._lctf.readCoverage(t,r.readUshort(t,a)+i),s.mark2Coverage=n._lctf.readCoverage(t,r.readUshort(t,a+2)+i),s.markClassCount=r.readUshort(t,a+4),s.mark1Array=n.GPOS.readMarkArray(t,r.readUshort(t,a+6)+i),s.mark2Array=n.GPOS.readBaseArray(t,r.readUshort(t,a+8)+i,s.markClassCount);else{if(e==9&&s.fmt==1){var D=r.readUshort(t,a);a+=2;var V=r.readUint(t,a);if(a+=4,o.ltype==9)o.ltype=D;else if(o.ltype!=D)throw"invalid extension substitution";return n.GPOS.subt(t,o.ltype,i+V)}console.debug("unsupported GPOS table LookupType",e,"format",s.fmt)}return s},n.GPOS.readValueRecord=function(t,e,a){var o=n._bin,r=[];return r.push(1&a?o.readShort(t,e):0),e+=1&a?2:0,r.push(2&a?o.readShort(t,e):0),e+=2&a?2:0,r.push(4&a?o.readShort(t,e):0),e+=4&a?2:0,r.push(8&a?o.readShort(t,e):0),e+=8&a?2:0,r},n.GPOS.readBaseArray=function(t,e,a){var o=n._bin,r=[],i=e,s=o.readUshort(t,e);e+=2;for(var l=0;l<s;l++){for(var u=[],f=0;f<a;f++)u.push(n.GPOS.readAnchorRecord(t,i+o.readUshort(t,e))),e+=2;r.push(u)}return r},n.GPOS.readMarkArray=function(t,e){var a=n._bin,o=[],r=e,i=a.readUshort(t,e);e+=2;for(var s=0;s<i;s++){var l=n.GPOS.readAnchorRecord(t,a.readUshort(t,e+2)+r);l.markClass=a.readUshort(t,e),o.push(l),e+=4}return o},n.GPOS.readAnchorRecord=function(t,e){var a=n._bin,o={};return o.fmt=a.readUshort(t,e),o.x=a.readShort(t,e+2),o.y=a.readShort(t,e+4),o},n.GSUB={},n.GSUB.parse=function(t,e,a,o){return n._lctf.parse(t,e,a,o,n.GSUB.subt)},n.GSUB.subt=function(t,e,a,o){var r=n._bin,i=a,s={};if(s.fmt=r.readUshort(t,a),a+=2,e!=1&&e!=2&&e!=4&&e!=5&&e!=6)return null;if(e==1||e==2||e==4||e==5&&s.fmt<=2||e==6&&s.fmt<=2){var l=r.readUshort(t,a);a+=2,s.coverage=n._lctf.readCoverage(t,i+l)}if(e==1&&s.fmt>=1&&s.fmt<=2){if(s.fmt==1)s.delta=r.readShort(t,a),a+=2;else if(s.fmt==2){var u=r.readUshort(t,a);a+=2,s.newg=r.readUshorts(t,a,u),a+=2*s.newg.length}}else if(e==2&&s.fmt==1){u=r.readUshort(t,a),a+=2,s.seqs=[];for(var f=0;f<u;f++){var p=r.readUshort(t,a)+i;a+=2;var m=r.readUshort(t,p);s.seqs.push(r.readUshorts(t,p+2,m))}}else if(e==4)for(s.vals=[],u=r.readUshort(t,a),a+=2,f=0;f<u;f++){var y=r.readUshort(t,a);a+=2,s.vals.push(n.GSUB.readLigatureSet(t,i+y))}else if(e==5&&s.fmt==2){if(s.fmt==2){var O=r.readUshort(t,a);a+=2,s.cDef=n._lctf.readClassDef(t,i+O),s.scset=[];var F=r.readUshort(t,a);for(a+=2,f=0;f<F;f++){var C=r.readUshort(t,a);a+=2,s.scset.push(C==0?null:n.GSUB.readSubClassSet(t,i+C))}}}else if(e==6&&s.fmt==3){if(s.fmt==3){for(f=0;f<3;f++){u=r.readUshort(t,a),a+=2;for(var x=[],k=0;k<u;k++)x.push(n._lctf.readCoverage(t,i+r.readUshort(t,a+2*k)));a+=2*u,f==0&&(s.backCvg=x),f==1&&(s.inptCvg=x),f==2&&(s.ahedCvg=x)}u=r.readUshort(t,a),a+=2,s.lookupRec=n.GSUB.readSubstLookupRecords(t,a,u)}}else{if(e==7&&s.fmt==1){var A=r.readUshort(t,a);a+=2;var S=r.readUint(t,a);if(a+=4,o.ltype==9)o.ltype=A;else if(o.ltype!=A)throw"invalid extension substitution";return n.GSUB.subt(t,o.ltype,i+S)}console.debug("unsupported GSUB table LookupType",e,"format",s.fmt)}return s},n.GSUB.readSubClassSet=function(t,e){var a=n._bin.readUshort,o=e,r=[],i=a(t,e);e+=2;for(var s=0;s<i;s++){var l=a(t,e);e+=2,r.push(n.GSUB.readSubClassRule(t,o+l))}return r},n.GSUB.readSubClassRule=function(t,e){var a=n._bin.readUshort,o={},r=a(t,e),i=a(t,e+=2);e+=2,o.input=[];for(var s=0;s<r-1;s++)o.input.push(a(t,e)),e+=2;return o.substLookupRecords=n.GSUB.readSubstLookupRecords(t,e,i),o},n.GSUB.readSubstLookupRecords=function(t,e,a){for(var o=n._bin.readUshort,r=[],i=0;i<a;i++)r.push(o(t,e),o(t,e+2)),e+=4;return r},n.GSUB.readChainSubClassSet=function(t,e){var a=n._bin,o=e,r=[],i=a.readUshort(t,e);e+=2;for(var s=0;s<i;s++){var l=a.readUshort(t,e);e+=2,r.push(n.GSUB.readChainSubClassRule(t,o+l))}return r},n.GSUB.readChainSubClassRule=function(t,e){for(var a=n._bin,o={},r=["backtrack","input","lookahead"],i=0;i<r.length;i++){var s=a.readUshort(t,e);e+=2,i==1&&s--,o[r[i]]=a.readUshorts(t,e,s),e+=2*o[r[i]].length}return s=a.readUshort(t,e),e+=2,o.subst=a.readUshorts(t,e,2*s),e+=2*o.subst.length,o},n.GSUB.readLigatureSet=function(t,e){var a=n._bin,o=e,r=[],i=a.readUshort(t,e);e+=2;for(var s=0;s<i;s++){var l=a.readUshort(t,e);e+=2,r.push(n.GSUB.readLigature(t,o+l))}return r},n.GSUB.readLigature=function(t,e){var a=n._bin,o={chain:[]};o.nglyph=a.readUshort(t,e),e+=2;var r=a.readUshort(t,e);e+=2;for(var i=0;i<r-1;i++)o.chain.push(a.readUshort(t,e)),e+=2;return o},n.head={},n.head.parse=function(t,e,a){var o=n._bin,r={};return o.readFixed(t,e),e+=4,r.fontRevision=o.readFixed(t,e),e+=4,o.readUint(t,e),e+=4,o.readUint(t,e),e+=4,r.flags=o.readUshort(t,e),e+=2,r.unitsPerEm=o.readUshort(t,e),e+=2,r.created=o.readUint64(t,e),e+=8,r.modified=o.readUint64(t,e),e+=8,r.xMin=o.readShort(t,e),e+=2,r.yMin=o.readShort(t,e),e+=2,r.xMax=o.readShort(t,e),e+=2,r.yMax=o.readShort(t,e),e+=2,r.macStyle=o.readUshort(t,e),e+=2,r.lowestRecPPEM=o.readUshort(t,e),e+=2,r.fontDirectionHint=o.readShort(t,e),e+=2,r.indexToLocFormat=o.readShort(t,e),e+=2,r.glyphDataFormat=o.readShort(t,e),e+=2,r},n.hhea={},n.hhea.parse=function(t,e,a){var o=n._bin,r={};return o.readFixed(t,e),e+=4,r.ascender=o.readShort(t,e),e+=2,r.descender=o.readShort(t,e),e+=2,r.lineGap=o.readShort(t,e),e+=2,r.advanceWidthMax=o.readUshort(t,e),e+=2,r.minLeftSideBearing=o.readShort(t,e),e+=2,r.minRightSideBearing=o.readShort(t,e),e+=2,r.xMaxExtent=o.readShort(t,e),e+=2,r.caretSlopeRise=o.readShort(t,e),e+=2,r.caretSlopeRun=o.readShort(t,e),e+=2,r.caretOffset=o.readShort(t,e),e+=2,e+=8,r.metricDataFormat=o.readShort(t,e),e+=2,r.numberOfHMetrics=o.readUshort(t,e),e+=2,r},n.hmtx={},n.hmtx.parse=function(t,e,a,o){for(var r=n._bin,i={aWidth:[],lsBearing:[]},s=0,l=0,u=0;u<o.maxp.numGlyphs;u++)u<o.hhea.numberOfHMetrics&&(s=r.readUshort(t,e),e+=2,l=r.readShort(t,e),e+=2),i.aWidth.push(s),i.lsBearing.push(l);return i},n.kern={},n.kern.parse=function(t,e,a,o){var r=n._bin,i=r.readUshort(t,e);if(e+=2,i==1)return n.kern.parseV1(t,e-2,a,o);var s=r.readUshort(t,e);e+=2;for(var l={glyph1:[],rval:[]},u=0;u<s;u++){e+=2,a=r.readUshort(t,e),e+=2;var f=r.readUshort(t,e);e+=2;var p=f>>>8;if((p&=15)!=0)throw"unknown kern table format: "+p;e=n.kern.readFormat0(t,e,l)}return l},n.kern.parseV1=function(t,e,a,o){var r=n._bin;r.readFixed(t,e),e+=4;var i=r.readUint(t,e);e+=4;for(var s={glyph1:[],rval:[]},l=0;l<i;l++){r.readUint(t,e),e+=4;var u=r.readUshort(t,e);e+=2,r.readUshort(t,e),e+=2;var f=u>>>8;if((f&=15)!=0)throw"unknown kern table format: "+f;e=n.kern.readFormat0(t,e,s)}return s},n.kern.readFormat0=function(t,e,a){var o=n._bin,r=-1,i=o.readUshort(t,e);e+=2,o.readUshort(t,e),e+=2,o.readUshort(t,e),e+=2,o.readUshort(t,e),e+=2;for(var s=0;s<i;s++){var l=o.readUshort(t,e);e+=2;var u=o.readUshort(t,e);e+=2;var f=o.readShort(t,e);e+=2,l!=r&&(a.glyph1.push(l),a.rval.push({glyph2:[],vals:[]}));var p=a.rval[a.rval.length-1];p.glyph2.push(u),p.vals.push(f),r=l}return e},n.loca={},n.loca.parse=function(t,e,a,o){var r=n._bin,i=[],s=o.head.indexToLocFormat,l=o.maxp.numGlyphs+1;if(s==0)for(var u=0;u<l;u++)i.push(r.readUshort(t,e+(u<<1))<<1);if(s==1)for(u=0;u<l;u++)i.push(r.readUint(t,e+(u<<2)));return i},n.maxp={},n.maxp.parse=function(t,e,a){var o=n._bin,r={},i=o.readUint(t,e);return e+=4,r.numGlyphs=o.readUshort(t,e),e+=2,i==65536&&(r.maxPoints=o.readUshort(t,e),e+=2,r.maxContours=o.readUshort(t,e),e+=2,r.maxCompositePoints=o.readUshort(t,e),e+=2,r.maxCompositeContours=o.readUshort(t,e),e+=2,r.maxZones=o.readUshort(t,e),e+=2,r.maxTwilightPoints=o.readUshort(t,e),e+=2,r.maxStorage=o.readUshort(t,e),e+=2,r.maxFunctionDefs=o.readUshort(t,e),e+=2,r.maxInstructionDefs=o.readUshort(t,e),e+=2,r.maxStackElements=o.readUshort(t,e),e+=2,r.maxSizeOfInstructions=o.readUshort(t,e),e+=2,r.maxComponentElements=o.readUshort(t,e),e+=2,r.maxComponentDepth=o.readUshort(t,e),e+=2),r},n.name={},n.name.parse=function(t,e,a){var o=n._bin,r={};o.readUshort(t,e),e+=2;var i=o.readUshort(t,e);e+=2,o.readUshort(t,e);for(var s,l=["copyright","fontFamily","fontSubfamily","ID","fullName","version","postScriptName","trademark","manufacturer","designer","description","urlVendor","urlDesigner","licence","licenceURL","---","typoFamilyName","typoSubfamilyName","compatibleFull","sampleText","postScriptCID","wwsFamilyName","wwsSubfamilyName","lightPalette","darkPalette"],u=e+=2,f=0;f<i;f++){var p=o.readUshort(t,e);e+=2;var m=o.readUshort(t,e);e+=2;var y=o.readUshort(t,e);e+=2;var O=o.readUshort(t,e);e+=2;var F=o.readUshort(t,e);e+=2;var C=o.readUshort(t,e);e+=2;var x,k=l[O],A=u+12*i+C;if(p==0)x=o.readUnicode(t,A,F/2);else if(p==3&&m==0)x=o.readUnicode(t,A,F/2);else if(m==0)x=o.readASCII(t,A,F);else if(m==1)x=o.readUnicode(t,A,F/2);else if(m==3)x=o.readUnicode(t,A,F/2);else{if(p!=1)throw"unknown encoding "+m+", platformID: "+p;x=o.readASCII(t,A,F),console.debug("reading unknown MAC encoding "+m+" as ASCII")}var S="p"+p+","+y.toString(16);r[S]==null&&(r[S]={}),r[S][k!==void 0?k:O]=x,r[S]._lang=y}for(var _ in r)if(r[_].postScriptName!=null&&r[_]._lang==1033)return r[_];for(var _ in r)if(r[_].postScriptName!=null&&r[_]._lang==0)return r[_];for(var _ in r)if(r[_].postScriptName!=null&&r[_]._lang==3084)return r[_];for(var _ in r)if(r[_].postScriptName!=null)return r[_];for(var _ in r){s=_;break}return console.debug("returning name table with languageID "+r[s]._lang),r[s]},n["OS/2"]={},n["OS/2"].parse=function(t,e,a){var o=n._bin.readUshort(t,e);e+=2;var r={};if(o==0)n["OS/2"].version0(t,e,r);else if(o==1)n["OS/2"].version1(t,e,r);else if(o==2||o==3||o==4)n["OS/2"].version2(t,e,r);else{if(o!=5)throw"unknown OS/2 table version: "+o;n["OS/2"].version5(t,e,r)}return r},n["OS/2"].version0=function(t,e,a){var o=n._bin;return a.xAvgCharWidth=o.readShort(t,e),e+=2,a.usWeightClass=o.readUshort(t,e),e+=2,a.usWidthClass=o.readUshort(t,e),e+=2,a.fsType=o.readUshort(t,e),e+=2,a.ySubscriptXSize=o.readShort(t,e),e+=2,a.ySubscriptYSize=o.readShort(t,e),e+=2,a.ySubscriptXOffset=o.readShort(t,e),e+=2,a.ySubscriptYOffset=o.readShort(t,e),e+=2,a.ySuperscriptXSize=o.readShort(t,e),e+=2,a.ySuperscriptYSize=o.readShort(t,e),e+=2,a.ySuperscriptXOffset=o.readShort(t,e),e+=2,a.ySuperscriptYOffset=o.readShort(t,e),e+=2,a.yStrikeoutSize=o.readShort(t,e),e+=2,a.yStrikeoutPosition=o.readShort(t,e),e+=2,a.sFamilyClass=o.readShort(t,e),e+=2,a.panose=o.readBytes(t,e,10),e+=10,a.ulUnicodeRange1=o.readUint(t,e),e+=4,a.ulUnicodeRange2=o.readUint(t,e),e+=4,a.ulUnicodeRange3=o.readUint(t,e),e+=4,a.ulUnicodeRange4=o.readUint(t,e),e+=4,a.achVendID=[o.readInt8(t,e),o.readInt8(t,e+1),o.readInt8(t,e+2),o.readInt8(t,e+3)],e+=4,a.fsSelection=o.readUshort(t,e),e+=2,a.usFirstCharIndex=o.readUshort(t,e),e+=2,a.usLastCharIndex=o.readUshort(t,e),e+=2,a.sTypoAscender=o.readShort(t,e),e+=2,a.sTypoDescender=o.readShort(t,e),e+=2,a.sTypoLineGap=o.readShort(t,e),e+=2,a.usWinAscent=o.readUshort(t,e),e+=2,a.usWinDescent=o.readUshort(t,e),e+=2},n["OS/2"].version1=function(t,e,a){var o=n._bin;return e=n["OS/2"].version0(t,e,a),a.ulCodePageRange1=o.readUint(t,e),e+=4,a.ulCodePageRange2=o.readUint(t,e),e+=4},n["OS/2"].version2=function(t,e,a){var o=n._bin;return e=n["OS/2"].version1(t,e,a),a.sxHeight=o.readShort(t,e),e+=2,a.sCapHeight=o.readShort(t,e),e+=2,a.usDefault=o.readUshort(t,e),e+=2,a.usBreak=o.readUshort(t,e),e+=2,a.usMaxContext=o.readUshort(t,e),e+=2},n["OS/2"].version5=function(t,e,a){var o=n._bin;return e=n["OS/2"].version2(t,e,a),a.usLowerOpticalPointSize=o.readUshort(t,e),e+=2,a.usUpperOpticalPointSize=o.readUshort(t,e),e+=2},n.post={},n.post.parse=function(t,e,a){var o=n._bin,r={};return r.version=o.readFixed(t,e),e+=4,r.italicAngle=o.readFixed(t,e),e+=4,r.underlinePosition=o.readShort(t,e),e+=2,r.underlineThickness=o.readShort(t,e),e+=2,r},n==null&&(n={}),n.U==null&&(n.U={}),n.U.codeToGlyph=function(t,e){var a=t.cmap,o=-1;if(a.p0e4!=null?o=a.p0e4:a.p3e1!=null?o=a.p3e1:a.p1e0!=null?o=a.p1e0:a.p0e3!=null&&(o=a.p0e3),o==-1)throw"no familiar platform and encoding!";var r=a.tables[o];if(r.format==0)return e>=r.map.length?0:r.map[e];if(r.format==4){for(var i=-1,s=0;s<r.endCount.length;s++)if(e<=r.endCount[s]){i=s;break}return i==-1||r.startCount[i]>e?0:65535&(r.idRangeOffset[i]!=0?r.glyphIdArray[e-r.startCount[i]+(r.idRangeOffset[i]>>1)-(r.idRangeOffset.length-i)]:e+r.idDelta[i])}if(r.format==12){if(e>r.groups[r.groups.length-1][1])return 0;for(s=0;s<r.groups.length;s++){var l=r.groups[s];if(l[0]<=e&&e<=l[1])return l[2]+(e-l[0])}return 0}throw"unknown cmap table format "+r.format},n.U.glyphToPath=function(t,e){var a={cmds:[],crds:[]};if(t.SVG&&t.SVG.entries[e]){var o=t.SVG.entries[e];return o==null?a:(typeof o=="string"&&(o=n.SVG.toPath(o),t.SVG.entries[e]=o),o)}if(t.CFF){var r={x:0,y:0,stack:[],nStems:0,haveWidth:!1,width:t.CFF.Private?t.CFF.Private.defaultWidthX:0,open:!1},i=t.CFF,s=t.CFF.Private;if(i.ROS){for(var l=0;i.FDSelect[l+2]<=e;)l+=2;s=i.FDArray[i.FDSelect[l+1]].Private}n.U._drawCFF(t.CFF.CharStrings[e],r,i,s,a)}else t.glyf&&n.U._drawGlyf(e,t,a);return a},n.U._drawGlyf=function(t,e,a){var o=e.glyf[t];o==null&&(o=e.glyf[t]=n.glyf._parseGlyf(e,t)),o!=null&&(o.noc>-1?n.U._simpleGlyph(o,a):n.U._compoGlyph(o,e,a))},n.U._simpleGlyph=function(t,e){for(var a=0;a<t.noc;a++){for(var o=a==0?0:t.endPts[a-1]+1,r=t.endPts[a],i=o;i<=r;i++){var s=i==o?r:i-1,l=i==r?o:i+1,u=1&t.flags[i],f=1&t.flags[s],p=1&t.flags[l],m=t.xs[i],y=t.ys[i];if(i==o)if(u){if(!f){n.U.P.moveTo(e,m,y);continue}n.U.P.moveTo(e,t.xs[s],t.ys[s])}else f?n.U.P.moveTo(e,t.xs[s],t.ys[s]):n.U.P.moveTo(e,(t.xs[s]+m)/2,(t.ys[s]+y)/2);u?f&&n.U.P.lineTo(e,m,y):p?n.U.P.qcurveTo(e,m,y,t.xs[l],t.ys[l]):n.U.P.qcurveTo(e,m,y,(m+t.xs[l])/2,(y+t.ys[l])/2)}n.U.P.closePath(e)}},n.U._compoGlyph=function(t,e,a){for(var o=0;o<t.parts.length;o++){var r={cmds:[],crds:[]},i=t.parts[o];n.U._drawGlyf(i.glyphIndex,e,r);for(var s=i.m,l=0;l<r.crds.length;l+=2){var u=r.crds[l],f=r.crds[l+1];a.crds.push(u*s.a+f*s.b+s.tx),a.crds.push(u*s.c+f*s.d+s.ty)}for(l=0;l<r.cmds.length;l++)a.cmds.push(r.cmds[l])}},n.U._getGlyphClass=function(t,e){var a=n._lctf.getInterval(e,t);return a==-1?0:e[a+2]},n.U._applySubs=function(t,e,a,o){for(var r=t.length-e-1,i=0;i<a.tabs.length;i++)if(a.tabs[i]!=null){var s,l=a.tabs[i];if(!l.coverage||(s=n._lctf.coverageIndex(l.coverage,t[e]))!=-1){if(a.ltype==1)t[e],l.fmt==1?t[e]=t[e]+l.delta:t[e]=l.newg[s];else if(a.ltype==4)for(var u=l.vals[s],f=0;f<u.length;f++){var p=u[f],m=p.chain.length;if(!(m>r)){for(var y=!0,O=0,F=0;F<m;F++){for(;t[e+O+(1+F)]==-1;)O++;p.chain[F]!=t[e+O+(1+F)]&&(y=!1)}if(y){for(t[e]=p.nglyph,F=0;F<m+O;F++)t[e+F+1]=-1;break}}}else if(a.ltype==5&&l.fmt==2)for(var C=n._lctf.getInterval(l.cDef,t[e]),x=l.cDef[C+2],k=l.scset[x],A=0;A<k.length;A++){var S=k[A],_=S.input;if(!(_.length>r)){for(y=!0,F=0;F<_.length;F++){var G=n._lctf.getInterval(l.cDef,t[e+1+F]);if(C==-1&&l.cDef[G+2]!=_[F]){y=!1;break}}if(y){var W=S.substLookupRecords;for(f=0;f<W.length;f+=2)W[f],W[f+1]}}}else if(a.ltype==6&&l.fmt==3){if(!n.U._glsCovered(t,l.backCvg,e-l.backCvg.length)||!n.U._glsCovered(t,l.inptCvg,e)||!n.U._glsCovered(t,l.ahedCvg,e+l.inptCvg.length))continue;var $=l.lookupRec;for(A=0;A<$.length;A+=2){C=$[A];var g=o[$[A+1]];n.U._applySubs(t,e+C,g,o)}}}}},n.U._glsCovered=function(t,e,a){for(var o=0;o<e.length;o++)if(n._lctf.coverageIndex(e[o],t[a+o])==-1)return!1;return!0},n.U.glyphsToPath=function(t,e,a){for(var o={cmds:[],crds:[]},r=0,i=0;i<e.length;i++){var s=e[i];if(s!=-1){for(var l=i<e.length-1&&e[i+1]!=-1?e[i+1]:0,u=n.U.glyphToPath(t,s),f=0;f<u.crds.length;f+=2)o.crds.push(u.crds[f]+r),o.crds.push(u.crds[f+1]);for(a&&o.cmds.push(a),f=0;f<u.cmds.length;f++)o.cmds.push(u.cmds[f]);a&&o.cmds.push("X"),r+=t.hmtx.aWidth[s],i<e.length-1&&(r+=n.U.getPairAdjustment(t,s,l))}}return o},n.U.P={},n.U.P.moveTo=function(t,e,a){t.cmds.push("M"),t.crds.push(e,a)},n.U.P.lineTo=function(t,e,a){t.cmds.push("L"),t.crds.push(e,a)},n.U.P.curveTo=function(t,e,a,o,r,i,s){t.cmds.push("C"),t.crds.push(e,a,o,r,i,s)},n.U.P.qcurveTo=function(t,e,a,o,r){t.cmds.push("Q"),t.crds.push(e,a,o,r)},n.U.P.closePath=function(t){t.cmds.push("Z")},n.U._drawCFF=function(t,e,a,o,r){for(var i=e.stack,s=e.nStems,l=e.haveWidth,u=e.width,f=e.open,p=0,m=e.x,y=e.y,O=0,F=0,C=0,x=0,k=0,A=0,S=0,_=0,G=0,W=0,$={val:0,size:0};p<t.length;){n.CFF.getCharString(t,p,$);var g=$.val;if(p+=$.size,g=="o1"||g=="o18")i.length%2!=0&&!l&&(u=i.shift()+o.nominalWidthX),s+=i.length>>1,i.length=0,l=!0;else if(g=="o3"||g=="o23")i.length%2!=0&&!l&&(u=i.shift()+o.nominalWidthX),s+=i.length>>1,i.length=0,l=!0;else if(g=="o4")i.length>1&&!l&&(u=i.shift()+o.nominalWidthX,l=!0),f&&n.U.P.closePath(r),y+=i.pop(),n.U.P.moveTo(r,m,y),f=!0;else if(g=="o5")for(;i.length>0;)m+=i.shift(),y+=i.shift(),n.U.P.lineTo(r,m,y);else if(g=="o6"||g=="o7")for(var E=i.length,D=g=="o6",V=0;V<E;V++){var N=i.shift();D?m+=N:y+=N,D=!D,n.U.P.lineTo(r,m,y)}else if(g=="o8"||g=="o24"){E=i.length;for(var re=0;re+6<=E;)O=m+i.shift(),F=y+i.shift(),C=O+i.shift(),x=F+i.shift(),m=C+i.shift(),y=x+i.shift(),n.U.P.curveTo(r,O,F,C,x,m,y),re+=6;g=="o24"&&(m+=i.shift(),y+=i.shift(),n.U.P.lineTo(r,m,y))}else{if(g=="o11")break;if(g=="o1234"||g=="o1235"||g=="o1236"||g=="o1237")g=="o1234"&&(F=y,C=(O=m+i.shift())+i.shift(),W=x=F+i.shift(),A=x,_=y,m=(S=(k=(G=C+i.shift())+i.shift())+i.shift())+i.shift(),n.U.P.curveTo(r,O,F,C,x,G,W),n.U.P.curveTo(r,k,A,S,_,m,y)),g=="o1235"&&(O=m+i.shift(),F=y+i.shift(),C=O+i.shift(),x=F+i.shift(),G=C+i.shift(),W=x+i.shift(),k=G+i.shift(),A=W+i.shift(),S=k+i.shift(),_=A+i.shift(),m=S+i.shift(),y=_+i.shift(),i.shift(),n.U.P.curveTo(r,O,F,C,x,G,W),n.U.P.curveTo(r,k,A,S,_,m,y)),g=="o1236"&&(O=m+i.shift(),F=y+i.shift(),C=O+i.shift(),W=x=F+i.shift(),A=x,S=(k=(G=C+i.shift())+i.shift())+i.shift(),_=A+i.shift(),m=S+i.shift(),n.U.P.curveTo(r,O,F,C,x,G,W),n.U.P.curveTo(r,k,A,S,_,m,y)),g=="o1237"&&(O=m+i.shift(),F=y+i.shift(),C=O+i.shift(),x=F+i.shift(),G=C+i.shift(),W=x+i.shift(),k=G+i.shift(),A=W+i.shift(),S=k+i.shift(),_=A+i.shift(),Math.abs(S-m)>Math.abs(_-y)?m=S+i.shift():y=_+i.shift(),n.U.P.curveTo(r,O,F,C,x,G,W),n.U.P.curveTo(r,k,A,S,_,m,y));else if(g=="o14"){if(i.length>0&&!l&&(u=i.shift()+a.nominalWidthX,l=!0),i.length==4){var se=i.shift(),R=i.shift(),I=i.shift(),v=i.shift(),b=n.CFF.glyphBySE(a,I),w=n.CFF.glyphBySE(a,v);n.U._drawCFF(a.CharStrings[b],e,a,o,r),e.x=se,e.y=R,n.U._drawCFF(a.CharStrings[w],e,a,o,r)}f&&(n.U.P.closePath(r),f=!1)}else if(g=="o19"||g=="o20")i.length%2!=0&&!l&&(u=i.shift()+o.nominalWidthX),s+=i.length>>1,i.length=0,l=!0,p+=s+7>>3;else if(g=="o21")i.length>2&&!l&&(u=i.shift()+o.nominalWidthX,l=!0),y+=i.pop(),m+=i.pop(),f&&n.U.P.closePath(r),n.U.P.moveTo(r,m,y),f=!0;else if(g=="o22")i.length>1&&!l&&(u=i.shift()+o.nominalWidthX,l=!0),m+=i.pop(),f&&n.U.P.closePath(r),n.U.P.moveTo(r,m,y),f=!0;else if(g=="o25"){for(;i.length>6;)m+=i.shift(),y+=i.shift(),n.U.P.lineTo(r,m,y);O=m+i.shift(),F=y+i.shift(),C=O+i.shift(),x=F+i.shift(),m=C+i.shift(),y=x+i.shift(),n.U.P.curveTo(r,O,F,C,x,m,y)}else if(g=="o26")for(i.length%2&&(m+=i.shift());i.length>0;)O=m,F=y+i.shift(),m=C=O+i.shift(),y=(x=F+i.shift())+i.shift(),n.U.P.curveTo(r,O,F,C,x,m,y);else if(g=="o27")for(i.length%2&&(y+=i.shift());i.length>0;)F=y,C=(O=m+i.shift())+i.shift(),x=F+i.shift(),m=C+i.shift(),y=x,n.U.P.curveTo(r,O,F,C,x,m,y);else if(g=="o10"||g=="o29"){var T=g=="o10"?o:a;if(i.length==0)console.debug("error: empty stack");else{var U=i.pop(),P=T.Subrs[U+T.Bias];e.x=m,e.y=y,e.nStems=s,e.haveWidth=l,e.width=u,e.open=f,n.U._drawCFF(P,e,a,o,r),m=e.x,y=e.y,s=e.nStems,l=e.haveWidth,u=e.width,f=e.open}}else if(g=="o30"||g=="o31"){var M=i.length,L=(re=0,g=="o31");for(re+=M-(E=-3&M);re<E;)L?(F=y,C=(O=m+i.shift())+i.shift(),y=(x=F+i.shift())+i.shift(),E-re==5?(m=C+i.shift(),re++):m=C,L=!1):(O=m,F=y+i.shift(),C=O+i.shift(),x=F+i.shift(),m=C+i.shift(),E-re==5?(y=x+i.shift(),re++):y=x,L=!0),n.U.P.curveTo(r,O,F,C,x,m,y),re+=4}else{if((g+"").charAt(0)=="o")throw console.debug("Unknown operation: "+g,t),g;i.push(g)}}}e.x=m,e.y=y,e.nStems=s,e.haveWidth=l,e.width=u,e.open=f};var d=n,h={Typr:d};return c.Typr=d,c.default=h,Object.defineProperty(c,"__esModule",{value:!0}),c})({}).Typr}/*!
Custom bundle of woff2otf (https://github.com/arty-name/woff2otf) with fflate
(https://github.com/101arrowz/fflate) for use in Troika text rendering. 
Original licenses apply: 
- fflate: https://github.com/101arrowz/fflate/blob/master/LICENSE (MIT)
- woff2otf.js: https://github.com/arty-name/woff2otf/blob/master/woff2otf.js (Apache2)
*/function ra(){return(function(c){var n=Uint8Array,d=Uint16Array,h=Uint32Array,t=new n([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),e=new n([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),a=new n([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),o=function(g,E){for(var D=new d(31),V=0;V<31;++V)D[V]=E+=1<<g[V-1];var N=new h(D[30]);for(V=1;V<30;++V)for(var re=D[V];re<D[V+1];++re)N[re]=re-D[V]<<5|V;return[D,N]},r=o(t,2),i=r[0],s=r[1];i[28]=258,s[258]=28;for(var l=o(e,0)[0],u=new d(32768),f=0;f<32768;++f){var p=(43690&f)>>>1|(21845&f)<<1;p=(61680&(p=(52428&p)>>>2|(13107&p)<<2))>>>4|(3855&p)<<4,u[f]=((65280&p)>>>8|(255&p)<<8)>>>1}var m=function(g,E,D){for(var V=g.length,N=0,re=new d(E);N<V;++N)++re[g[N]-1];var se,R=new d(E);for(N=0;N<E;++N)R[N]=R[N-1]+re[N-1]<<1;{se=new d(1<<E);var I=15-E;for(N=0;N<V;++N)if(g[N])for(var v=N<<4|g[N],b=E-g[N],w=R[g[N]-1]++<<b,T=w|(1<<b)-1;w<=T;++w)se[u[w]>>>I]=v}return se},y=new n(288);for(f=0;f<144;++f)y[f]=8;for(f=144;f<256;++f)y[f]=9;for(f=256;f<280;++f)y[f]=7;for(f=280;f<288;++f)y[f]=8;var O=new n(32);for(f=0;f<32;++f)O[f]=5;var F=m(y,9),C=m(O,5),x=function(g){for(var E=g[0],D=1;D<g.length;++D)g[D]>E&&(E=g[D]);return E},k=function(g,E,D){var V=E/8|0;return(g[V]|g[V+1]<<8)>>(7&E)&D},A=function(g,E){var D=E/8|0;return(g[D]|g[D+1]<<8|g[D+2]<<16)>>(7&E)},S=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],_=function(g,E,D){var V=new Error(E||S[g]);if(V.code=g,Error.captureStackTrace&&Error.captureStackTrace(V,_),!D)throw V;return V},G=function(g,E,D){var V=g.length;if(!V||D&&!D.l&&V<5)return E||new n(0);var N=!E||D,re=!D||D.i;D||(D={}),E||(E=new n(3*V));var se,R=function(me){var we=E.length;if(me>we){var ke=new n(Math.max(2*we,me));ke.set(E),E=ke}},I=D.f||0,v=D.p||0,b=D.b||0,w=D.l,T=D.d,U=D.m,P=D.n,M=8*V;do{if(!w){D.f=I=k(g,v,1);var L=k(g,v+1,3);if(v+=3,!L){var H=g[(Y=((se=v)/8|0)+(7&se&&1)+4)-4]|g[Y-3]<<8,Q=Y+H;if(Q>V){re&&_(0);break}N&&R(b+H),E.set(g.subarray(Y,Q),b),D.b=b+=H,D.p=v=8*Q;continue}if(L==1)w=F,T=C,U=9,P=5;else if(L==2){var X=k(g,v,31)+257,z=k(g,v+10,15)+4,fe=X+k(g,v+5,31)+1;v+=14;for(var he=new n(fe),ne=new n(19),J=0;J<z;++J)ne[a[J]]=k(g,v+3*J,7);v+=3*z;var le=x(ne),j=(1<<le)-1,oe=m(ne,le);for(J=0;J<fe;){var Y,B=oe[k(g,v,j)];if(v+=15&B,(Y=B>>>4)<16)he[J++]=Y;else{var pe=0,q=0;for(Y==16?(q=3+k(g,v,3),v+=2,pe=he[J-1]):Y==17?(q=3+k(g,v,7),v+=3):Y==18&&(q=11+k(g,v,127),v+=7);q--;)he[J++]=pe}}var ee=he.subarray(0,X),K=he.subarray(X);U=x(ee),P=x(K),w=m(ee,U),T=m(K,P)}else _(1);if(v>M){re&&_(0);break}}N&&R(b+131072);for(var te=(1<<U)-1,ge=(1<<P)-1,Z=v;;Z=v){var ce=(pe=w[A(g,v)&te])>>>4;if((v+=15&pe)>M){re&&_(0);break}if(pe||_(2),ce<256)E[b++]=ce;else{if(ce==256){Z=v,w=null;break}var Ue=ce-254;if(ce>264){var _e=t[J=ce-257];Ue=k(g,v,(1<<_e)-1)+i[J],v+=_e}var ye=T[A(g,v)&ge],Fe=ye>>>4;if(ye||_(3),v+=15&ye,K=l[Fe],Fe>3&&(_e=e[Fe],K+=A(g,v)&(1<<_e)-1,v+=_e),v>M){re&&_(0);break}N&&R(b+131072);for(var ie=b+Ue;b<ie;b+=4)E[b]=E[b-K],E[b+1]=E[b+1-K],E[b+2]=E[b+2-K],E[b+3]=E[b+3-K];b=ie}}D.l=w,D.p=Z,D.b=b,w&&(I=1,D.m=U,D.d=T,D.n=P)}while(!I);return b==E.length?E:(function(me,we,ke){(ke==null||ke>me.length)&&(ke=me.length);var Ae=new(me instanceof d?d:me instanceof h?h:n)(ke-we);return Ae.set(me.subarray(we,ke)),Ae})(E,0,b)},W=new n(0),$=typeof TextDecoder<"u"&&new TextDecoder;try{$.decode(W,{stream:!0})}catch{}return c.convert_streams=function(g){var E=new DataView(g),D=0;function V(){var X=E.getUint16(D);return D+=2,X}function N(){var X=E.getUint32(D);return D+=4,X}function re(X){H.setUint16(Q,X),Q+=2}function se(X){H.setUint32(Q,X),Q+=4}for(var R={signature:N(),flavor:N(),length:N(),numTables:V(),reserved:V(),totalSfntSize:N(),majorVersion:V(),minorVersion:V(),metaOffset:N(),metaLength:N(),metaOrigLength:N(),privOffset:N(),privLength:N()},I=0;Math.pow(2,I)<=R.numTables;)I++;I--;for(var v=16*Math.pow(2,I),b=16*R.numTables-v,w=12,T=[],U=0;U<R.numTables;U++)T.push({tag:N(),offset:N(),compLength:N(),origLength:N(),origChecksum:N()}),w+=16;var P,M=new Uint8Array(12+16*T.length+T.reduce(function(X,z){return X+z.origLength+4},0)),L=M.buffer,H=new DataView(L),Q=0;return se(R.flavor),re(R.numTables),re(v),re(I),re(b),T.forEach(function(X){se(X.tag),se(X.origChecksum),se(w),se(X.origLength),X.outOffset=w,(w+=X.origLength)%4!=0&&(w+=4-w%4)}),T.forEach(function(X){var z,fe=g.slice(X.offset,X.offset+X.compLength);if(X.compLength!=X.origLength){var he=new Uint8Array(X.origLength);z=new Uint8Array(fe,2),G(z,he)}else he=new Uint8Array(fe);M.set(he,X.outOffset);var ne=0;(w=X.outOffset+X.origLength)%4!=0&&(ne=4-w%4),M.set(new Uint8Array(ne).buffer,X.outOffset+X.origLength),P=w+ne}),L.slice(0,P)},Object.defineProperty(c,"__esModule",{value:!0}),c})({}).convert_streams}function aa(c,n){const d={M:2,L:2,Q:4,C:6,Z:0},h={C:"18g,ca,368,1kz",D:"17k,6,2,2+4,5+c,2+6,2+1,10+1,9+f,j+11,2+1,a,2,2+1,15+2,3,j+2,6+3,2+8,2,2,2+1,w+a,4+e,3+3,2,3+2,3+5,23+w,2f+4,3,2+9,2,b,2+3,3,1k+9,6+1,3+1,2+2,2+d,30g,p+y,1,1+1g,f+x,2,sd2+1d,jf3+4,f+3,2+4,2+2,b+3,42,2,4+2,2+1,2,3,t+1,9f+w,2,el+2,2+g,d+2,2l,2+1,5,3+1,2+1,2,3,6,16wm+1v",R:"17m+3,2,2,6+3,m,15+2,2+2,h+h,13,3+8,2,2,3+1,2,p+1,x,5+4,5,a,2,2,3,u,c+2,g+1,5,2+1,4+1,5j,6+1,2,b,2+2,f,2+1,1s+2,2,3+1,7,1ez0,2,2+1,4+4,b,4,3,b,42,2+2,4,3,2+1,2,o+3,ae,ep,x,2o+2,3+1,3,5+1,6",L:"x9u,jff,a,fd,jv",T:"4t,gj+33,7o+4,1+1,7c+18,2,2+1,2+1,2,21+a,2,1b+k,h,2u+6,3+5,3+1,2+3,y,2,v+q,2k+a,1n+8,a,p+3,2+8,2+2,2+4,18+2,3c+e,2+v,1k,2,5+7,5,4+6,b+1,u,1n,5+3,9,l+1,r,3+1,1m,5+1,5+1,3+2,4,v+1,4,c+1,1m,5+4,2+1,5,l+1,n+5,2,1n,3,2+3,9,8+1,c+1,v,1q,d,1f,4,1m+2,6+2,2+3,8+1,c+1,u,1n,3,7,6+1,l+1,t+1,1m+1,5+3,9,l+1,u,21,8+2,2,2j,3+6,d+7,2r,3+8,c+5,23+1,s,2,2,1k+d,2+4,2+1,6+a,2+z,a,2v+3,2+5,2+1,3+1,q+1,5+2,h+3,e,3+1,7,g,jk+2,qb+2,u+2,u+1,v+1,1t+1,2+6,9,3+a,a,1a+2,3c+1,z,3b+2,5+1,a,7+2,64+1,3,1n,2+6,2,2,3+7,7+9,3,1d+d,1,1+1,1s+3,1d,2+4,2,6,15+8,d+1,x+3,3+1,2+2,1l,2+1,4,2+2,1n+7,3+1,49+2,2+c,2+6,5,7,4+1,5j+1l,2+4,ek,3+1,r+4,1e+4,6+5,2p+c,1+3,1,1+2,1+b,2db+2,3y,2p+v,ff+3,30+1,n9x,1+2,2+9,x+1,29+1,7l,4,5,q+1,6,48+1,r+h,e,13+7,q+a,1b+2,1d,3+3,3+1,14,1w+5,3+1,3+1,d,9,1c,1g,2+2,3+1,6+1,2,17+1,9,6n,3,5,fn5,ki+f,h+f,5s,6y+2,ea,6b,46+4,1af+2,2+1,6+3,15+2,5,4m+1,fy+3,as+1,4a+a,4x,1j+e,1l+2,1e+3,3+1,1y+2,11+4,2+7,1r,d+1,1h+8,b+3,3,2o+2,3,2+1,7,4h,4+7,m+1,1m+1,4,12+6,4+4,5g+7,3+2,2,o,2d+5,2,5+1,2+1,6n+3,7+1,2+1,s+1,2e+7,3,2+1,2z,2,3+5,2,2u+2,3+3,2+4,78+8,2+1,75+1,2,5,41+3,3+1,5,x+9,15+5,3+3,9,a+5,3+2,1b+c,2+1,bb+6,2+5,2,2b+l,3+6,2+1,2+1,3f+5,4,2+1,2+6,2,21+1,4,2,9o+1,470+8,at4+4,1o+6,t5,1s+3,2a,f5l+1,2+3,43o+2,a+7,1+7,3+6,v+3,45+2,1j0+1i,5+1d,9,f,n+4,2+e,11t+6,2+g,3+6,2+1,2+4,7a+6,c6+3,15t+6,32+6,1,gzau,v+2n,3l+6n"},t=1,e=2,a=4,o=8,r=16,i=32;let s;function l(S){if(!s){const _={R:e,L:t,D:a,C:r,U:i,T:o};s=new Map;for(let G in h){let W=0;h[G].split(",").forEach($=>{let[g,E]=$.split("+");g=parseInt(g,36),E=E?parseInt(E,36):0,s.set(W+=g,_[G]);for(let D=E;D--;)s.set(++W,_[G])})}}return s.get(S)||i}const u=1,f=2,p=3,m=4,y=[null,"isol","init","fina","medi"];function O(S){const _=new Uint8Array(S.length);let G=i,W=u,$=-1;for(let g=0;g<S.length;g++){const E=S.codePointAt(g);let D=l(E)|0,V=u;D&o||(G&(t|a|r)?D&(e|a|r)?(V=p,(W===u||W===p)&&_[$]++):D&(t|i)&&(W===f||W===m)&&_[$]--:G&(e|i)&&(W===f||W===m)&&_[$]--,W=_[g]=V,G=D,$=g,E>65535&&g++)}return _}function F(S,_){const G=[];for(let $=0;$<_.length;$++){const g=_.codePointAt($);g>65535&&$++,G.push(c.U.codeToGlyph(S,g))}const W=S.GSUB;if(W){const{lookupList:$,featureList:g}=W;let E;const D=/^(rlig|liga|mset|isol|init|fina|medi|half|pres|blws|ccmp)$/,V=[];g.forEach(N=>{if(D.test(N.tag))for(let re=0;re<N.tab.length;re++){if(V[N.tab[re]])continue;V[N.tab[re]]=!0;const se=$[N.tab[re]],R=/^(isol|init|fina|medi)$/.test(N.tag);R&&!E&&(E=O(_));for(let I=0;I<G.length;I++)(!E||!R||y[E[I]]===N.tag)&&c.U._applySubs(G,I,se,$)}})}return G}function C(S,_){const G=new Int16Array(_.length*3);let W=0;for(;W<_.length;W++){const D=_[W];if(D===-1)continue;G[W*3+2]=S.hmtx.aWidth[D];const V=S.GPOS;if(V){const N=V.lookupList;for(let re=0;re<N.length;re++){const se=N[re];for(let R=0;R<se.tabs.length;R++){const I=se.tabs[R];if(se.ltype===1){if(c._lctf.coverageIndex(I.coverage,D)!==-1&&I.pos){E(I.pos,W);break}}else if(se.ltype===2){let v=null,b=$();if(b!==-1){const w=c._lctf.coverageIndex(I.coverage,_[b]);if(w!==-1){if(I.fmt===1){const T=I.pairsets[w];for(let U=0;U<T.length;U++)T[U].gid2===D&&(v=T[U])}else if(I.fmt===2){const T=c.U._getGlyphClass(_[b],I.classDef1),U=c.U._getGlyphClass(D,I.classDef2);v=I.matrix[T][U]}if(v){v.val1&&E(v.val1,b),v.val2&&E(v.val2,W);break}}}}else if(se.ltype===4){const v=c._lctf.coverageIndex(I.markCoverage,D);if(v!==-1){const b=$(g),w=b===-1?-1:c._lctf.coverageIndex(I.baseCoverage,_[b]);if(w!==-1){const T=I.markArray[v],U=I.baseArray[w][T.markClass];G[W*3]=U.x-T.x+G[b*3]-G[b*3+2],G[W*3+1]=U.y-T.y+G[b*3+1];break}}}else if(se.ltype===6){const v=c._lctf.coverageIndex(I.mark1Coverage,D);if(v!==-1){const b=$();if(b!==-1){const w=_[b];if(x(S,w)===3){const T=c._lctf.coverageIndex(I.mark2Coverage,w);if(T!==-1){const U=I.mark1Array[v],P=I.mark2Array[T][U.markClass];G[W*3]=P.x-U.x+G[b*3]-G[b*3+2],G[W*3+1]=P.y-U.y+G[b*3+1];break}}}}}}}}else if(S.kern&&!S.cff){const N=$();if(N!==-1){const re=S.kern.glyph1.indexOf(_[N]);if(re!==-1){const se=S.kern.rval[re].glyph2.indexOf(D);se!==-1&&(G[N*3+2]+=S.kern.rval[re].vals[se])}}}}return G;function $(D){for(let V=W-1;V>=0;V--)if(_[V]!==-1&&(!D||D(_[V])))return V;return-1}function g(D){return x(S,D)===1}function E(D,V){for(let N=0;N<3;N++)G[V*3+N]+=D[N]||0}}function x(S,_){const G=S.GDEF&&S.GDEF.glyphClassDef;return G?c.U._getGlyphClass(_,G):0}function k(...S){for(let _=0;_<S.length;_++)if(typeof S[_]=="number")return S[_]}function A(S){const _=Object.create(null),G=S["OS/2"],W=S.hhea,$=S.head.unitsPerEm,g=k(G&&G.sTypoAscender,W&&W.ascender,$),E={unitsPerEm:$,ascender:g,descender:k(G&&G.sTypoDescender,W&&W.descender,0),capHeight:k(G&&G.sCapHeight,g),xHeight:k(G&&G.sxHeight,g),lineGap:k(G&&G.sTypoLineGap,W&&W.lineGap),supportsCodePoint(D){return c.U.codeToGlyph(S,D)>0},forEachGlyph(D,V,N,re){let se=0;const R=1/E.unitsPerEm*V,I=F(S,D);let v=0;const b=C(S,I);return I.forEach((w,T)=>{if(w!==-1){let U=_[w];if(!U){const{cmds:P,crds:M}=c.U.glyphToPath(S,w);let L="",H=0;for(let he=0,ne=P.length;he<ne;he++){const J=d[P[he]];L+=P[he];for(let le=1;le<=J;le++)L+=(le>1?",":"")+M[H++]}let Q,X,z,fe;if(M.length){Q=X=1/0,z=fe=-1/0;for(let he=0,ne=M.length;he<ne;he+=2){let J=M[he],le=M[he+1];J<Q&&(Q=J),le<X&&(X=le),J>z&&(z=J),le>fe&&(fe=le)}}else Q=z=X=fe=0;U=_[w]={index:w,advanceWidth:S.hmtx.aWidth[w],xMin:Q,yMin:X,xMax:z,yMax:fe,path:L}}re.call(null,U,se+b[T*3]*R,b[T*3+1]*R,v),se+=b[T*3+2]*R,N&&(se+=N*V)}v+=D.codePointAt(v)>65535?2:1}),se}};return E}return function(S){const _=new Uint8Array(S,0,4),G=c._bin.readASCII(_,0,4);if(G==="wOFF")S=n(S);else if(G==="wOF2")throw new Error("woff2 fonts not supported");return A(c.parse(S)[0])}}const oa=ot({name:"Typr Font Parser",dependencies:[na,ra,aa],init(c,n,d){const h=c(),t=n();return d(h,t)}});/*!
Custom bundle of @unicode-font-resolver/client v1.0.2 (https://github.com/lojjic/unicode-font-resolver)
for use in Troika text rendering. 
Original MIT license applies
*/function ia(){return(function(c){var n=function(){this.buckets=new Map};n.prototype.add=function(C){var x=C>>5;this.buckets.set(x,(this.buckets.get(x)||0)|1<<(31&C))},n.prototype.has=function(C){var x=this.buckets.get(C>>5);return x!==void 0&&(x&1<<(31&C))!=0},n.prototype.serialize=function(){var C=[];return this.buckets.forEach(function(x,k){C.push((+k).toString(36)+":"+x.toString(36))}),C.join(",")},n.prototype.deserialize=function(C){var x=this;this.buckets.clear(),C.split(",").forEach(function(k){var A=k.split(":");x.buckets.set(parseInt(A[0],36),parseInt(A[1],36))})};var d=Math.pow(2,8),h=d-1,t=~h;function e(C){var x=(function(A){return A&t})(C).toString(16),k=(function(A){return(A&t)+d-1})(C).toString(16);return"codepoint-index/plane"+(C>>16)+"/"+x+"-"+k+".json"}function a(C,x){var k=C&h,A=x.codePointAt(k/6|0);return((A=(A||48)-48)&1<<k%6)!=0}function o(C,x){var k;(k=C,k.replace(/U\+/gi,"").replace(/^,+|,+$/g,"").split(/,+/).map(function(A){return A.split("-").map(function(S){return parseInt(S.trim(),16)})})).forEach(function(A){var S=A[0],_=A[1];_===void 0&&(_=S),x(S,_)})}function r(C,x){o(C,function(k,A){for(var S=k;S<=A;S++)x(S)})}var i={},s={},l=new WeakMap,u="https://cdn.jsdelivr.net/gh/lojjic/unicode-font-resolver@v1.0.1/packages/data";function f(C){var x=l.get(C);return x||(x=new n,r(C.ranges,function(k){return x.add(k)}),l.set(C,x)),x}var p,m=new Map;function y(C,x,k){return C[x]?x:C[k]?k:(function(A){for(var S in A)return S})(C)}function O(C,x){var k=x;if(!C.includes(k)){k=1/0;for(var A=0;A<C.length;A++)Math.abs(C[A]-x)<Math.abs(k-x)&&(k=C[A])}return k}function F(C){return p||(p=new Set,r("9-D,20,85,A0,1680,2000-200A,2028-202F,205F,3000",function(x){p.add(x)})),p.has(C)}return c.CodePointSet=n,c.clearCache=function(){i={},s={}},c.getFontsForString=function(C,x){x===void 0&&(x={});var k,A=x.lang;A===void 0&&(A=new RegExp("\\p{Script=Hangul}","u").test(k=C)?"ko":new RegExp("\\p{Script=Hiragana}|\\p{Script=Katakana}","u").test(k)?"ja":"en");var S=x.category;S===void 0&&(S="sans-serif");var _=x.style;_===void 0&&(_="normal");var G=x.weight;G===void 0&&(G=400);var W=(x.dataUrl||u).replace(/\/$/g,""),$=new Map,g=new Uint8Array(C.length),E={},D={},V=new Array(C.length),N=new Map,re=!1;function se(v){var b=m.get(v);return b||(b=fetch(W+"/"+v).then(function(w){if(!w.ok)throw new Error(w.statusText);return w.json().then(function(T){if(!Array.isArray(T)||T[0]!==1)throw new Error("Incorrect schema version; need 1, got "+T[0]);return T[1]})}).catch(function(w){if(W!==u)return re||(console.error('unicode-font-resolver: Failed loading from dataUrl "'+W+'", trying default CDN. '+w.message),re=!0),W=u,m.delete(v),se(v);throw w}),m.set(v,b)),b}for(var R=function(v){var b=C.codePointAt(v),w=e(b);V[v]=w,i[w]||N.has(w)||N.set(w,se(w).then(function(T){i[w]=T})),b>65535&&(v++,I=v)},I=0;I<C.length;I++)R(I);return Promise.all(N.values()).then(function(){N.clear();for(var v=function(w){var T=C.codePointAt(w),U=null,P=i[V[w]],M=void 0;for(var L in P){var H=D[L];if(H===void 0&&(H=D[L]=new RegExp(L).test(A||"en")),H){for(var Q in M=L,P[L])if(a(T,P[L][Q])){U=Q;break}break}}if(!U){e:for(var X in P)if(X!==M){for(var z in P[X])if(a(T,P[X][z])){U=z;break e}}}U||(console.debug("No font coverage for U+"+T.toString(16)),U="latin"),V[w]=U,s[U]||N.has(U)||N.set(U,se("font-meta/"+U+".json").then(function(fe){s[U]=fe})),T>65535&&(w++,b=w)},b=0;b<C.length;b++)v(b);return Promise.all(N.values())}).then(function(){for(var v,b=null,w=0;w<C.length;w++){var T=C.codePointAt(w);if(b&&(F(T)||f(b).has(T)))g[w]=g[w-1];else{b=s[V[w]];var U=E[b.id];if(!U){var P=b.typeforms,M=y(P,S,"sans-serif"),L=y(P[M],_,"normal"),H=O((v=P[M])===null||v===void 0?void 0:v[L],G);U=E[b.id]=W+"/font-files/"+b.id+"/"+M+"."+L+"."+H+".woff"}var Q=$.get(U);Q==null&&(Q=$.size,$.set(U,Q)),g[w]=Q}T>65535&&(w++,g[w]=g[w-1])}return{fontUrls:Array.from($.keys()),chars:g}})},Object.defineProperty(c,"__esModule",{value:!0}),c})({})}function sa(c,n){const d=Object.create(null),h=Object.create(null);function t(a,o){const r=i=>{console.error(`Failure loading font ${a}`,i)};try{const i=new XMLHttpRequest;i.open("get",a,!0),i.responseType="arraybuffer",i.onload=function(){if(i.status>=400)r(new Error(i.statusText));else if(i.status>0)try{const s=c(i.response);s.src=a,o(s)}catch(s){r(s)}},i.onerror=r,i.send()}catch(i){r(i)}}function e(a,o){let r=d[a];r?o(r):h[a]?h[a].push(o):(h[a]=[o],t(a,i=>{i.src=a,d[a]=i,h[a].forEach(s=>s(i)),delete h[a]}))}return function(a,o,{lang:r,fonts:i=[],style:s="normal",weight:l="normal",unicodeFontsURL:u}={}){const f=new Uint8Array(a.length),p=[];a.length||F();const m=new Map,y=[];if(s!=="italic"&&(s="normal"),typeof l!="number"&&(l=l==="bold"?700:400),i&&!Array.isArray(i)&&(i=[i]),i=i.slice().filter(x=>!x.lang||x.lang.test(r)).reverse(),i.length){let x=0;(function k(A=0){for(let S=A,_=a.length;S<_;S++){const G=a.codePointAt(S);if(x===1&&p[f[S-1]].supportsCodePoint(G)||/\s/.test(a[S]))f[S]=f[S-1],x===2&&(y[y.length-1][1]=S);else for(let W=f[S],$=i.length;W<=$;W++)if(W===$){const g=x===2?y[y.length-1]:y[y.length]=[S,S];g[1]=S,x=2}else{f[S]=W;const{src:g,unicodeRange:E}=i[W];if(!E||C(G,E)){const D=d[g];if(!D){e(g,()=>{k(S)});return}if(D.supportsCodePoint(G)){let V=m.get(D);typeof V!="number"&&(V=p.length,p.push(D),m.set(D,V)),f[S]=V,x=1;break}}}G>65535&&S+1<_&&(f[S+1]=f[S],S++,x===2&&(y[y.length-1][1]=S))}O()})()}else y.push([0,a.length-1]),O();function O(){if(y.length){const x=y.map(k=>a.substring(k[0],k[1]+1)).join(`
`);n.getFontsForString(x,{lang:r||void 0,style:s,weight:l,dataUrl:u}).then(({fontUrls:k,chars:A})=>{const S=p.length;let _=0;y.forEach(W=>{for(let $=0,g=W[1]-W[0];$<=g;$++)f[W[0]+$]=A[_++]+S;_++});let G=0;k.forEach((W,$)=>{e(W,g=>{p[$+S]=g,++G===k.length&&F()})})})}else F()}function F(){o({chars:f,fonts:p})}function C(x,k){for(let A=0;A<k.length;A++){const[S,_=S]=k[A];if(S<=x&&x<=_)return!0}return!1}}}const la=ot({name:"FontResolver",dependencies:[sa,oa,ia],init(c,n,d){return c(n,d())}});function ua(c,n){const d=/[\u00AD\u034F\u061C\u115F-\u1160\u17B4-\u17B5\u180B-\u180E\u200B-\u200F\u202A-\u202E\u2060-\u206F\u3164\uFE00-\uFE0F\uFEFF\uFFA0\uFFF0-\uFFF8]/,h="[^\\S\\u00A0]",t=new RegExp(`${h}|[\\-\\u007C\\u00AD\\u2010\\u2012-\\u2014\\u2027\\u2056\\u2E17\\u2E40]`);function e({text:f,lang:p,fonts:m,style:y,weight:O,preResolvedFonts:F,unicodeFontsURL:C},x){const k=({chars:A,fonts:S})=>{let _,G;const W=[];for(let $=0;$<A.length;$++)A[$]!==G?(G=A[$],W.push(_={start:$,end:$,fontObj:S[A[$]]})):_.end=$;x(W)};F?k(F):c(f,k,{lang:p,fonts:m,style:y,weight:O,unicodeFontsURL:C})}function a({text:f="",font:p,lang:m,sdfGlyphSize:y=64,fontSize:O=400,fontWeight:F=1,fontStyle:C="normal",letterSpacing:x=0,lineHeight:k="normal",maxWidth:A=1/0,direction:S,textAlign:_="left",textIndent:G=0,whiteSpace:W="normal",overflowWrap:$="normal",anchorX:g=0,anchorY:E=0,metricsOnly:D=!1,unicodeFontsURL:V,preResolvedFonts:N=null,includeCaretPositions:re=!1,chunkedBoundsSize:se=8192,colorRanges:R=null},I){const v=s(),b={fontLoad:0,typesetting:0};f.indexOf("\r")>-1&&(console.info("Typesetter: got text with \\r chars; normalizing to \\n"),f=f.replace(/\r\n/g,`
`).replace(/\r/g,`
`)),O=+O,x=+x,A=+A,k=k||"normal",G=+G,e({text:f,lang:m,style:C,weight:F,fonts:typeof p=="string"?[{src:p}]:p,unicodeFontsURL:V,preResolvedFonts:N},w=>{b.fontLoad=s()-v;const T=isFinite(A);let U=null,P=null,M=null,L=null,H=null,Q=null,X=null,z=null,fe=0,he=0,ne=W!=="nowrap";const J=new Map,le=s();let j=G,oe=0,Y=new l;const B=[Y];w.forEach(te=>{const{fontObj:ge}=te,{ascender:Z,descender:ce,unitsPerEm:Ue,lineGap:_e,capHeight:ye,xHeight:Fe}=ge;let ie=J.get(ge);if(!ie){const ue=O/Ue,de=k==="normal"?(Z-ce+_e)*ue:k*O,Ve=(de-(Z-ce)*ue)/2,xe=Math.min(de,(Z-ce)*ue),be=(Z+ce)/2*ue+xe/2;ie={index:J.size,src:ge.src,fontObj:ge,fontSizeMult:ue,unitsPerEm:Ue,ascender:Z*ue,descender:ce*ue,capHeight:ye*ue,xHeight:Fe*ue,lineHeight:de,baseline:-Ve-Z*ue,caretTop:(Z+ce)/2*ue+xe/2,caretBottom:be-xe},J.set(ge,ie)}const{fontSizeMult:me}=ie,we=f.slice(te.start,te.end+1);let ke,Ae;ge.forEachGlyph(we,O,x,(ue,de,Ve,xe)=>{de+=oe,xe+=te.start,ke=de,Ae=ue;const be=f.charAt(xe),De=ue.advanceWidth*me,Te=Y.count;let ve;if("isEmpty"in ue||(ue.isWhitespace=!!be&&new RegExp(h).test(be),ue.canBreakAfter=!!be&&t.test(be),ue.isEmpty=ue.xMin===ue.xMax||ue.yMin===ue.yMax||d.test(be)),!ue.isWhitespace&&!ue.isEmpty&&he++,ne&&T&&!ue.isWhitespace&&de+De+j>A&&Te){if(Y.glyphAt(Te-1).glyphObj.canBreakAfter)ve=new l,j=-de;else for(let Me=Te;Me--;)if(Me===0&&$==="break-word"){ve=new l,j=-de;break}else if(Y.glyphAt(Me).glyphObj.canBreakAfter){ve=Y.splitAt(Me+1);const Oe=ve.glyphAt(0).x;j-=Oe;for(let Ce=ve.count;Ce--;)ve.glyphAt(Ce).x-=Oe;break}ve&&(Y.isSoftWrapped=!0,Y=ve,B.push(Y),fe=A)}let Se=Y.glyphAt(Y.count);Se.glyphObj=ue,Se.x=de+j,Se.y=Ve,Se.width=De,Se.charIndex=xe,Se.fontData=ie,be===`
`&&(Y=new l,B.push(Y),j=-(de+De+x*O)+G)}),oe=ke+Ae.advanceWidth*me+x*O});let pe=0;B.forEach(te=>{let ge=!0;for(let Z=te.count;Z--;){const ce=te.glyphAt(Z);ge&&!ce.glyphObj.isWhitespace&&(te.width=ce.x+ce.width,te.width>fe&&(fe=te.width),ge=!1);let{lineHeight:Ue,capHeight:_e,xHeight:ye,baseline:Fe}=ce.fontData;Ue>te.lineHeight&&(te.lineHeight=Ue);const ie=Fe-te.baseline;ie<0&&(te.baseline+=ie,te.cap+=ie,te.ex+=ie),te.cap=Math.max(te.cap,te.baseline+_e),te.ex=Math.max(te.ex,te.baseline+ye)}te.baseline-=pe,te.cap-=pe,te.ex-=pe,pe+=te.lineHeight});let q=0,ee=0;if(g&&(typeof g=="number"?q=-g:typeof g=="string"&&(q=-fe*(g==="left"?0:g==="center"?.5:g==="right"?1:r(g)))),E&&(typeof E=="number"?ee=-E:typeof E=="string"&&(ee=E==="top"?0:E==="top-baseline"?-B[0].baseline:E==="top-cap"?-B[0].cap:E==="top-ex"?-B[0].ex:E==="middle"?pe/2:E==="bottom"?pe:E==="bottom-baseline"?B[B.length-1].baseline:r(E)*pe)),!D){const te=n.getEmbeddingLevels(f,S);U=new Uint16Array(he),P=new Uint8Array(he),M=new Float32Array(he*2),L={},X=[1/0,1/0,-1/0,-1/0],z=[],re&&(Q=new Float32Array(f.length*4)),R&&(H=new Uint8Array(he*3));let ge=0,Z=-1,ce=-1,Ue,_e;if(B.forEach((ye,Fe)=>{let{count:ie,width:me}=ye;if(ie>0){let we=0;for(let xe=ie;xe--&&ye.glyphAt(xe).glyphObj.isWhitespace;)we++;let ke=0,Ae=0;if(_==="center")ke=(fe-me)/2;else if(_==="right")ke=fe-me;else if(_==="justify"&&ye.isSoftWrapped){let xe=0;for(let be=ie-we;be--;)ye.glyphAt(be).glyphObj.isWhitespace&&xe++;Ae=(fe-me)/xe}if(Ae||ke){let xe=0;for(let be=0;be<ie;be++){let De=ye.glyphAt(be);const Te=De.glyphObj;De.x+=ke+xe,Ae!==0&&Te.isWhitespace&&be<ie-we&&(xe+=Ae,De.width+=Ae)}}const ue=n.getReorderSegments(f,te,ye.glyphAt(0).charIndex,ye.glyphAt(ye.count-1).charIndex);for(let xe=0;xe<ue.length;xe++){const[be,De]=ue[xe];let Te=1/0,ve=-1/0;for(let Se=0;Se<ie;Se++)if(ye.glyphAt(Se).charIndex>=be){let Me=Se,Oe=Se;for(;Oe<ie;Oe++){let Ce=ye.glyphAt(Oe);if(Ce.charIndex>De)break;Oe<ie-we&&(Te=Math.min(Te,Ce.x),ve=Math.max(ve,Ce.x+Ce.width))}for(let Ce=Me;Ce<Oe;Ce++){const We=ye.glyphAt(Ce);We.x=ve-(We.x+We.width-Te)}break}}let de;const Ve=xe=>de=xe;for(let xe=0;xe<ie;xe++){const be=ye.glyphAt(xe);de=be.glyphObj;const De=de.index,Te=te.levels[be.charIndex]&1;if(Te){const ve=n.getMirroredCharacter(f[be.charIndex]);ve&&be.fontData.fontObj.forEachGlyph(ve,0,0,Ve)}if(re){const{charIndex:ve,fontData:Se}=be,Me=be.x+q,Oe=be.x+be.width+q;Q[ve*4]=Te?Oe:Me,Q[ve*4+1]=Te?Me:Oe,Q[ve*4+2]=ye.baseline+Se.caretBottom+ee,Q[ve*4+3]=ye.baseline+Se.caretTop+ee;const Ce=ve-Z;Ce>1&&i(Q,Z,Ce),Z=ve}if(R){const{charIndex:ve}=be;for(;ve>ce;)ce++,R.hasOwnProperty(ce)&&(_e=R[ce])}if(!de.isWhitespace&&!de.isEmpty){const ve=ge++,{fontSizeMult:Se,src:Me,index:Oe}=be.fontData,Ce=L[Me]||(L[Me]={});Ce[De]||(Ce[De]={path:de.path,pathBounds:[de.xMin,de.yMin,de.xMax,de.yMax]});const We=be.x+q,qe=be.y+ye.baseline+ee;M[ve*2]=We,M[ve*2+1]=qe;const Ne=We+de.xMin*Se,Xe=qe+de.yMin*Se,$e=We+de.xMax*Se,Ze=qe+de.yMax*Se;Ne<X[0]&&(X[0]=Ne),Xe<X[1]&&(X[1]=Xe),$e>X[2]&&(X[2]=$e),Ze>X[3]&&(X[3]=Ze),ve%se===0&&(Ue={start:ve,end:ve,rect:[1/0,1/0,-1/0,-1/0]},z.push(Ue)),Ue.end++;const Ge=Ue.rect;if(Ne<Ge[0]&&(Ge[0]=Ne),Xe<Ge[1]&&(Ge[1]=Xe),$e>Ge[2]&&(Ge[2]=$e),Ze>Ge[3]&&(Ge[3]=Ze),U[ve]=De,P[ve]=Oe,R){const je=ve*3;H[je]=_e>>16&255,H[je+1]=_e>>8&255,H[je+2]=_e&255}}}}}),Q){const ye=f.length-Z;ye>1&&i(Q,Z,ye)}}const K=[];J.forEach(({index:te,src:ge,unitsPerEm:Z,ascender:ce,descender:Ue,lineHeight:_e,capHeight:ye,xHeight:Fe})=>{K[te]={src:ge,unitsPerEm:Z,ascender:ce,descender:Ue,lineHeight:_e,capHeight:ye,xHeight:Fe}}),b.typesetting=s()-le,I({glyphIds:U,glyphFontIndices:P,glyphPositions:M,glyphData:L,fontData:K,caretPositions:Q,glyphColors:H,chunkedBounds:z,fontSize:O,topBaseline:ee+B[0].baseline,blockBounds:[q,ee-pe,q+fe,ee],visibleBounds:X,timings:b})})}function o(f,p){a({...f,metricsOnly:!0},m=>{const[y,O,F,C]=m.blockBounds;p({width:F-y,height:C-O})})}function r(f){let p=f.match(/^([\d.]+)%$/),m=p?parseFloat(p[1]):NaN;return isNaN(m)?0:m/100}function i(f,p,m){const y=f[p*4],O=f[p*4+1],F=f[p*4+2],C=f[p*4+3],x=(O-y)/m;for(let k=0;k<m;k++){const A=(p+k)*4;f[A]=y+x*k,f[A+1]=y+x*(k+1),f[A+2]=F,f[A+3]=C}}function s(){return(self.performance||Date).now()}function l(){this.data=[]}const u=["glyphObj","x","y","width","charIndex","fontData"];return l.prototype={width:0,lineHeight:0,baseline:0,cap:0,ex:0,isSoftWrapped:!1,get count(){return Math.ceil(this.data.length/u.length)},glyphAt(f){let p=l.flyweight;return p.data=this.data,p.index=f,p},splitAt(f){let p=new l;return p.data=this.data.splice(f*u.length),p}},l.flyweight=u.reduce((f,p,m,y)=>(Object.defineProperty(f,p,{get(){return this.data[this.index*u.length+m]},set(O){this.data[this.index*u.length+m]=O}}),f),{data:null,index:0}),{typeset:a,measure:o}}const Je=()=>(self.performance||Date).now(),Lt=lr();let qn;function fa(c,n,d,h,t,e,a,o,r,i,s=!0){return s?ca(c,n,d,h,t,e,a,o,r,i).then(null,l=>(qn||(console.warn("WebGL SDF generation failed, falling back to JS",l),qn=!0),Qn(c,n,d,h,t,e,a,o,r,i))):Qn(c,n,d,h,t,e,a,o,r,i)}const Rt=[],ha=5;let vn=0;function fr(){const c=Je();for(;Rt.length&&Je()-c<ha;)Rt.shift()();vn=Rt.length?setTimeout(fr,0):0}const ca=(...c)=>new Promise((n,d)=>{Rt.push(()=>{const h=Je();try{Lt.webgl.generateIntoCanvas(...c),n({timing:Je()-h})}catch(t){d(t)}}),vn||(vn=setTimeout(fr,0))}),da=4,va=2e3,Zn={};let pa=0;function Qn(c,n,d,h,t,e,a,o,r,i){const s="TroikaTextSDFGenerator_JS_"+pa++%da;let l=Zn[s];return l||(l=Zn[s]={workerModule:ot({name:s,workerId:s,dependencies:[lr,Je],init(u,f){const p=u().javascript.generate;return function(...m){const y=f();return{textureData:p(...m),timing:f()-y}}},getTransferables(u){return[u.textureData.buffer]}}),requests:0,idleTimer:null}),l.requests++,clearTimeout(l.idleTimer),l.workerModule(c,n,d,h,t,e).then(({textureData:u,timing:f})=>{const p=Je(),m=new Uint8Array(u.length*4);for(let y=0;y<u.length;y++)m[y*4+i]=u[y];return Lt.webglUtils.renderImageData(a,m,o,r,c,n,1<<3-i),f+=Je()-p,--l.requests===0&&(l.idleTimer=setTimeout(()=>{$r(s)},va)),{timing:f}})}function ga(c){c._warm||(Lt.webgl.isSupported(c),c._warm=!0)}const ma=Lt.webglUtils.resizeWebGLCanvasWithoutClearing,Ke={defaultFontURL:null,unicodeFontsURL:null,sdfGlyphSize:64,sdfMargin:1/16,sdfExponent:9,textureWidth:2048},ya=new gn;let hr=!1;function at(){return(self.performance||Date).now()}function La(c){hr?console.warn("configureTextBuilder called after first font request; will be ignored."):vr(Ke,c)}const Bt=Object.create(null);function cr(c,n){hr=!0,c=vr({},c);const d=at(),{defaultFontURL:h}=Ke,t=[];if(h&&t.push({label:"default",src:Kn(h)}),c.font&&t.push({label:"user",src:Kn(c.font)}),c.font=t,c.text=""+c.text,c.sdfGlyphSize=c.sdfGlyphSize||Ke.sdfGlyphSize,c.unicodeFontsURL=c.unicodeFontsURL||Ke.unicodeFontsURL,c.colorRanges!=null){let u={};for(let f in c.colorRanges)if(c.colorRanges.hasOwnProperty(f)){let p=c.colorRanges[f];typeof p!="number"&&(p=ya.set(p).getHex()),u[f]=p}c.colorRanges=u}Object.freeze(c);const{textureWidth:e,sdfExponent:a}=Ke,{sdfGlyphSize:o}=c,r=e/o*4;let i=Bt[o];if(!i){const u=document.createElement("canvas");u.width=e,u.height=o*256/r,i=Bt[o]={glyphCount:0,sdfGlyphSize:o,sdfCanvas:u,sdfTexture:new Ar(u,void 0,void 0,void 0,Nn,Nn),contextLost:!1,glyphsByFont:new Map},i.sdfTexture.generateMipmaps=!1,ba(i)}const{sdfTexture:s,sdfCanvas:l}=i;Sa(c).then(u=>{const{glyphIds:f,glyphFontIndices:p,fontData:m,glyphPositions:y,fontSize:O,timings:F}=u,C=[],x=new Float32Array(f.length*4);let k=0,A=0;const S=at(),_=m.map(E=>{let D=i.glyphsByFont.get(E.src);return D||i.glyphsByFont.set(E.src,D=new Map),D});f.forEach((E,D)=>{const V=p[D],{src:N,unitsPerEm:re}=m[V];let se=_[V].get(E);if(!se){const{path:w,pathBounds:T}=u.glyphData[N][E],U=Math.max(T[2]-T[0],T[3]-T[1])/o*(Ke.sdfMargin*o+.5),P=i.glyphCount++,M=[T[0]-U,T[1]-U,T[2]+U,T[3]+U];_[V].set(E,se={path:w,atlasIndex:P,sdfViewBox:M}),C.push(se)}const{sdfViewBox:R}=se,I=y[A++],v=y[A++],b=O/re;x[k++]=I+R[0]*b,x[k++]=v+R[1]*b,x[k++]=I+R[2]*b,x[k++]=v+R[3]*b,f[D]=se.atlasIndex}),F.quads=(F.quads||0)+(at()-S);const G=at();F.sdf={};const W=l.height,$=Math.ceil(i.glyphCount/r),g=Math.pow(2,Math.ceil(Math.log2($*o)));g>W&&(console.info(`Increasing SDF texture size ${W}->${g}`),ma(l,e,g),s.dispose()),Promise.all(C.map(E=>dr(E,i,c.gpuAccelerateSDF).then(({timing:D})=>{F.sdf[E.atlasIndex]=D}))).then(()=>{C.length&&!i.contextLost&&(pr(i),s.needsUpdate=!0),F.sdfTotal=at()-G,F.total=at()-d,n(Object.freeze({parameters:c,sdfTexture:s,sdfGlyphSize:o,sdfExponent:a,glyphBounds:x,glyphAtlasIndices:f,glyphColors:u.glyphColors,caretPositions:u.caretPositions,chunkedBounds:u.chunkedBounds,ascender:u.ascender,descender:u.descender,lineHeight:u.lineHeight,capHeight:u.capHeight,xHeight:u.xHeight,topBaseline:u.topBaseline,blockBounds:u.blockBounds,visibleBounds:u.visibleBounds,timings:u.timings}))})}),Promise.resolve().then(()=>{i.contextLost||ga(l)})}function dr({path:c,atlasIndex:n,sdfViewBox:d},{sdfGlyphSize:h,sdfCanvas:t,contextLost:e},a){if(e)return Promise.resolve({timing:-1});const{textureWidth:o,sdfExponent:r}=Ke,i=Math.max(d[2]-d[0],d[3]-d[1]),s=Math.floor(n/4),l=s%(o/h)*h,u=Math.floor(s/(o/h))*h,f=n%4;return fa(h,h,c,d,i,r,t,l,u,f,a)}function ba(c){const n=c.sdfCanvas;n.addEventListener("webglcontextlost",d=>{console.log("Context Lost",d),d.preventDefault(),c.contextLost=!0}),n.addEventListener("webglcontextrestored",d=>{console.log("Context Restored",d),c.contextLost=!1;const h=[];c.glyphsByFont.forEach(t=>{t.forEach(e=>{h.push(dr(e,c,!0))})}),Promise.all(h).then(()=>{pr(c),c.sdfTexture.needsUpdate=!0})})}function Pa({font:c,characters:n,sdfGlyphSize:d},h){let t=Array.isArray(n)?n.join(`
`):""+n;cr({font:c,sdfGlyphSize:d,text:t},h)}function vr(c,n){for(let d in n)n.hasOwnProperty(d)&&(c[d]=n[d]);return c}let Ot;function Kn(c){return Ot||(Ot=typeof document>"u"?{}:document.createElement("a")),Ot.href=c,Ot.href}function pr(c){if(typeof createImageBitmap!="function"){console.info("Safari<15: applying SDF canvas workaround");const{sdfCanvas:n,sdfTexture:d}=c,{width:h,height:t}=n,e=c.sdfCanvas.getContext("webgl");let a=d.image.data;(!a||a.length!==h*t*4)&&(a=new Uint8Array(h*t*4),d.image={width:h,height:t,data:a},d.flipY=!1,d.isDataTexture=!0),e.readPixels(0,0,h,t,e.RGBA,e.UNSIGNED_BYTE,a)}}const xa=ot({name:"Typesetter",dependencies:[ua,la,Yr],init(c,n,d){return c(n,d())}}),Sa=ot({name:"Typesetter",dependencies:[xa],init(c){return function(n){return new Promise(d=>{c.typeset(n,d)})}},getTransferables(c){const n=[];for(let d in c)c[d]&&c[d].buffer&&n.push(c[d].buffer);return n}});function ja(){Object.keys(Bt).forEach(c=>{const n=Bt[c].sdfCanvas,{width:d,height:h}=n;console.log("%c.",`
      background: url(${n.toDataURL()});
      background-size: ${d}px ${h}px;
      color: transparent;
      font-size: 0;
      line-height: ${h}px;
      padding-left: ${d}px;
    `)})}const Jn={};function Ua(c){let n=Jn[c];if(!n){const d=new yn(1,1,c,c),h=d.clone(),t=d.attributes,e=h.attributes,a=new Ir,o=t.uv.count;for(let r=0;r<o;r++)e.position.array[r*3]*=-1,e.normal.array[r*3+2]*=-1;["position","normal","uv"].forEach(r=>{a.setAttribute(r,new Rr([...t[r].array,...e[r].array],t[r].itemSize))}),a.setIndex([...d.index.array,...h.index.array.map(r=>r+o)]),a.translate(.5,.5,0),n=Jn[c]=a}return n}const ka="aTroikaGlyphBounds",er="aTroikaGlyphIndex",_a="aTroikaGlyphColor";class wa extends wr{constructor(){super(),this.detail=1,this.curveRadius=0,this.groups=[{start:0,count:1/0,materialIndex:0},{start:0,count:1/0,materialIndex:1}],this.boundingSphere=new Tr,this.boundingBox=new Cr}computeBoundingSphere(){}computeBoundingBox(){}setSide(n){const d=this.getIndex().count;this.setDrawRange(n===Fr?d/2:0,n===ir?d:d/2)}set detail(n){if(n!==this._detail){this._detail=n,(typeof n!="number"||n<1)&&(n=1);let d=Ua(n);["position","normal","uv"].forEach(h=>{this.attributes[h]=d.attributes[h].clone()}),this.setIndex(d.getIndex().clone())}}get detail(){return this._detail}set curveRadius(n){n!==this._curveRadius&&(this._curveRadius=n,this._updateBounds())}get curveRadius(){return this._curveRadius}updateGlyphs(n,d,h,t,e){ln(this,ka,n,4),ln(this,er,d,1),ln(this,_a,e,3),this._blockBounds=h,this._chunkedBounds=t,this.instanceCount=d.length,this._updateBounds()}_updateBounds(){const n=this._blockBounds;if(n){const{curveRadius:d,boundingBox:h}=this;if(d){const{PI:t,floor:e,min:a,max:o,sin:r,cos:i}=Math,s=t/2,l=t*2,u=Math.abs(d),f=n[0]/u,p=n[2]/u,m=e((f+s)/l)!==e((p+s)/l)?-u:a(r(f)*u,r(p)*u),y=e((f-s)/l)!==e((p-s)/l)?u:o(r(f)*u,r(p)*u),O=e((f+t)/l)!==e((p+t)/l)?u*2:o(u-i(f)*u,u-i(p)*u);h.min.set(m,n[1],d<0?-O:0),h.max.set(y,n[3],d<0?0:O)}else h.min.set(n[0],n[1],0),h.max.set(n[2],n[3],0);h.getBoundingSphere(this.boundingSphere)}}applyClipRect(n){let d=this.getAttribute(er).count,h=this._chunkedBounds;if(h)for(let t=h.length;t--;){d=h[t].end;let e=h[t].rect;if(e[1]<n.w&&e[3]>n.y&&e[0]<n.z&&e[2]>n.x)break}this.instanceCount=d}}function ln(c,n,d,h){const t=c.getAttribute(n);d?t&&t.array.length===d.length?(t.array.set(d),t.needsUpdate=!0):(c.setAttribute(n,new Gr(d,h)),delete c._maxInstanceCount,c.dispose()):t&&c.deleteAttribute(n)}const Ta=`
uniform vec2 uTroikaSDFTextureSize;
uniform float uTroikaSDFGlyphSize;
uniform vec4 uTroikaTotalBounds;
uniform vec4 uTroikaClipRect;
uniform mat3 uTroikaOrient;
uniform bool uTroikaUseGlyphColors;
uniform float uTroikaDistanceOffset;
uniform float uTroikaBlurRadius;
uniform vec2 uTroikaPositionOffset;
uniform float uTroikaCurveRadius;
attribute vec4 aTroikaGlyphBounds;
attribute float aTroikaGlyphIndex;
attribute vec3 aTroikaGlyphColor;
varying vec2 vTroikaGlyphUV;
varying vec4 vTroikaTextureUVBounds;
varying float vTroikaTextureChannel;
varying vec3 vTroikaGlyphColor;
varying vec2 vTroikaGlyphDimensions;
`,Ca=`
vec4 bounds = aTroikaGlyphBounds;
bounds.xz += uTroikaPositionOffset.x;
bounds.yw -= uTroikaPositionOffset.y;

vec4 outlineBounds = vec4(
  bounds.xy - uTroikaDistanceOffset - uTroikaBlurRadius,
  bounds.zw + uTroikaDistanceOffset + uTroikaBlurRadius
);
vec4 clippedBounds = vec4(
  clamp(outlineBounds.xy, uTroikaClipRect.xy, uTroikaClipRect.zw),
  clamp(outlineBounds.zw, uTroikaClipRect.xy, uTroikaClipRect.zw)
);

vec2 clippedXY = (mix(clippedBounds.xy, clippedBounds.zw, position.xy) - bounds.xy) / (bounds.zw - bounds.xy);

position.xy = mix(bounds.xy, bounds.zw, clippedXY);

uv = (position.xy - uTroikaTotalBounds.xy) / (uTroikaTotalBounds.zw - uTroikaTotalBounds.xy);

float rad = uTroikaCurveRadius;
if (rad != 0.0) {
  float angle = position.x / rad;
  position.xz = vec2(sin(angle) * rad, rad - cos(angle) * rad);
  normal.xz = vec2(sin(angle), cos(angle));
}
  
position = uTroikaOrient * position;
normal = uTroikaOrient * normal;

vTroikaGlyphUV = clippedXY.xy;
vTroikaGlyphDimensions = vec2(bounds[2] - bounds[0], bounds[3] - bounds[1]);


float txCols = uTroikaSDFTextureSize.x / uTroikaSDFGlyphSize;
vec2 txUvPerSquare = uTroikaSDFGlyphSize / uTroikaSDFTextureSize;
vec2 txStartUV = txUvPerSquare * vec2(
  mod(floor(aTroikaGlyphIndex / 4.0), txCols),
  floor(floor(aTroikaGlyphIndex / 4.0) / txCols)
);
vTroikaTextureUVBounds = vec4(txStartUV, vec2(txStartUV) + txUvPerSquare);
vTroikaTextureChannel = mod(aTroikaGlyphIndex, 4.0);
`,Fa=`
uniform sampler2D uTroikaSDFTexture;
uniform vec2 uTroikaSDFTextureSize;
uniform float uTroikaSDFGlyphSize;
uniform float uTroikaSDFExponent;
uniform float uTroikaDistanceOffset;
uniform float uTroikaFillOpacity;
uniform float uTroikaOutlineOpacity;
uniform float uTroikaBlurRadius;
uniform vec3 uTroikaStrokeColor;
uniform float uTroikaStrokeWidth;
uniform float uTroikaStrokeOpacity;
uniform bool uTroikaSDFDebug;
varying vec2 vTroikaGlyphUV;
varying vec4 vTroikaTextureUVBounds;
varying float vTroikaTextureChannel;
varying vec2 vTroikaGlyphDimensions;

float troikaSdfValueToSignedDistance(float alpha) {
  // Inverse of exponential encoding in webgl-sdf-generator
  
  float maxDimension = max(vTroikaGlyphDimensions.x, vTroikaGlyphDimensions.y);
  float absDist = (1.0 - pow(2.0 * (alpha > 0.5 ? 1.0 - alpha : alpha), 1.0 / uTroikaSDFExponent)) * maxDimension;
  float signedDist = absDist * (alpha > 0.5 ? -1.0 : 1.0);
  return signedDist;
}

float troikaGlyphUvToSdfValue(vec2 glyphUV) {
  vec2 textureUV = mix(vTroikaTextureUVBounds.xy, vTroikaTextureUVBounds.zw, glyphUV);
  vec4 rgba = texture2D(uTroikaSDFTexture, textureUV);
  float ch = floor(vTroikaTextureChannel + 0.5); //NOTE: can't use round() in WebGL1
  return ch == 0.0 ? rgba.r : ch == 1.0 ? rgba.g : ch == 2.0 ? rgba.b : rgba.a;
}

float troikaGlyphUvToDistance(vec2 uv) {
  return troikaSdfValueToSignedDistance(troikaGlyphUvToSdfValue(uv));
}

float troikaGetAADist() {
  
  #if defined(GL_OES_standard_derivatives) || __VERSION__ >= 300
  return length(fwidth(vTroikaGlyphUV * vTroikaGlyphDimensions)) * 0.5;
  #else
  return vTroikaGlyphDimensions.x / 64.0;
  #endif
}

float troikaGetFragDistValue() {
  vec2 clampedGlyphUV = clamp(vTroikaGlyphUV, 0.5 / uTroikaSDFGlyphSize, 1.0 - 0.5 / uTroikaSDFGlyphSize);
  float distance = troikaGlyphUvToDistance(clampedGlyphUV);
 
  // Extrapolate distance when outside bounds:
  distance += clampedGlyphUV == vTroikaGlyphUV ? 0.0 : 
    length((vTroikaGlyphUV - clampedGlyphUV) * vTroikaGlyphDimensions);

  

  return distance;
}

float troikaGetEdgeAlpha(float distance, float distanceOffset, float aaDist) {
  #if defined(IS_DEPTH_MATERIAL) || defined(IS_DISTANCE_MATERIAL)
  float alpha = step(-distanceOffset, -distance);
  #else

  float alpha = smoothstep(
    distanceOffset + aaDist,
    distanceOffset - aaDist,
    distance
  );
  #endif

  return alpha;
}
`,Da=`
float aaDist = troikaGetAADist();
float fragDistance = troikaGetFragDistValue();
float edgeAlpha = uTroikaSDFDebug ?
  troikaGlyphUvToSdfValue(vTroikaGlyphUV) :
  troikaGetEdgeAlpha(fragDistance, uTroikaDistanceOffset, max(aaDist, uTroikaBlurRadius));

#if !defined(IS_DEPTH_MATERIAL) && !defined(IS_DISTANCE_MATERIAL)
vec4 fillRGBA = gl_FragColor;
fillRGBA.a *= uTroikaFillOpacity;
vec4 strokeRGBA = uTroikaStrokeWidth == 0.0 ? fillRGBA : vec4(uTroikaStrokeColor, uTroikaStrokeOpacity);
if (fillRGBA.a == 0.0) fillRGBA.rgb = strokeRGBA.rgb;
gl_FragColor = mix(fillRGBA, strokeRGBA, smoothstep(
  -uTroikaStrokeWidth - aaDist,
  -uTroikaStrokeWidth + aaDist,
  fragDistance
));
gl_FragColor.a *= edgeAlpha;
#endif

if (edgeAlpha == 0.0) {
  discard;
}
`;function Ea(c){const n=dn(c,{chained:!0,extensions:{derivatives:!0},uniforms:{uTroikaSDFTexture:{value:null},uTroikaSDFTextureSize:{value:new Gt},uTroikaSDFGlyphSize:{value:0},uTroikaSDFExponent:{value:0},uTroikaTotalBounds:{value:new Wn(0,0,0,0)},uTroikaClipRect:{value:new Wn(0,0,0,0)},uTroikaDistanceOffset:{value:0},uTroikaOutlineOpacity:{value:0},uTroikaFillOpacity:{value:1},uTroikaPositionOffset:{value:new Gt},uTroikaCurveRadius:{value:0},uTroikaBlurRadius:{value:0},uTroikaStrokeWidth:{value:0},uTroikaStrokeColor:{value:new gn},uTroikaStrokeOpacity:{value:1},uTroikaOrient:{value:new Or},uTroikaUseGlyphColors:{value:!0},uTroikaSDFDebug:{value:!1}},vertexDefs:Ta,vertexTransform:Ca,fragmentDefs:Fa,fragmentColorTransform:Da,customRewriter({vertexShader:d,fragmentShader:h}){let t=/\buniform\s+vec3\s+diffuse\b/;return t.test(h)&&(h=h.replace(t,"varying vec3 vTroikaGlyphColor").replace(/\bdiffuse\b/g,"vTroikaGlyphColor"),t.test(d)||(d=d.replace(ur,`uniform vec3 diffuse;
$&
vTroikaGlyphColor = uTroikaUseGlyphColors ? aTroikaGlyphColor / 255.0 : diffuse;
`))),{vertexShader:d,fragmentShader:h}}});return n.transparent=!0,Object.defineProperties(n,{isTroikaTextMaterial:{value:!0},shadowSide:{get(){return this.side},set(){}}}),n}const bn=new Er({color:16777215,side:ir,transparent:!0}),tr=8421504,nr=new Mr,At=new mn,un=new mn,gt=[],Ma=new mn,fn="+x+y";function rr(c){return Array.isArray(c)?c[0]:c}let gr=()=>{const c=new pn(new yn(1,1),bn);return gr=()=>c,c},mr=()=>{const c=new pn(new yn(1,1,32,1),bn);return mr=()=>c,c};const Oa={type:"syncstart"},Aa={type:"synccomplete"},yr=["font","fontSize","fontStyle","fontWeight","lang","letterSpacing","lineHeight","maxWidth","overflowWrap","text","direction","textAlign","textIndent","whiteSpace","anchorX","anchorY","colorRanges","sdfGlyphSize"],Ia=yr.concat("material","color","depthOffset","clipRect","curveRadius","orientation","glyphGeometryDetail");class Ra extends pn{constructor(){const n=new wa;super(n,null),this.text="",this.anchorX=0,this.anchorY=0,this.curveRadius=0,this.direction="auto",this.font=null,this.unicodeFontsURL=null,this.fontSize=.1,this.fontWeight="normal",this.fontStyle="normal",this.lang=null,this.letterSpacing=0,this.lineHeight="normal",this.maxWidth=1/0,this.overflowWrap="normal",this.textAlign="left",this.textIndent=0,this.whiteSpace="normal",this.material=null,this.color=null,this.colorRanges=null,this.outlineWidth=0,this.outlineColor=0,this.outlineOpacity=1,this.outlineBlur=0,this.outlineOffsetX=0,this.outlineOffsetY=0,this.strokeWidth=0,this.strokeColor=tr,this.strokeOpacity=1,this.fillOpacity=1,this.depthOffset=0,this.clipRect=null,this.orientation=fn,this.glyphGeometryDetail=1,this.sdfGlyphSize=null,this.gpuAccelerateSDF=!0,this.debugSDF=!1}sync(n){this._needsSync&&(this._needsSync=!1,this._isSyncing?(this._queuedSyncs||(this._queuedSyncs=[])).push(n):(this._isSyncing=!0,this.dispatchEvent(Oa),cr({text:this.text,font:this.font,lang:this.lang,fontSize:this.fontSize||.1,fontWeight:this.fontWeight||"normal",fontStyle:this.fontStyle||"normal",letterSpacing:this.letterSpacing||0,lineHeight:this.lineHeight||"normal",maxWidth:this.maxWidth,direction:this.direction||"auto",textAlign:this.textAlign,textIndent:this.textIndent,whiteSpace:this.whiteSpace,overflowWrap:this.overflowWrap,anchorX:this.anchorX,anchorY:this.anchorY,colorRanges:this.colorRanges,includeCaretPositions:!0,sdfGlyphSize:this.sdfGlyphSize,gpuAccelerateSDF:this.gpuAccelerateSDF,unicodeFontsURL:this.unicodeFontsURL},d=>{this._isSyncing=!1,this._textRenderInfo=d,this.geometry.updateGlyphs(d.glyphBounds,d.glyphAtlasIndices,d.blockBounds,d.chunkedBounds,d.glyphColors);const h=this._queuedSyncs;h&&(this._queuedSyncs=null,this._needsSync=!0,this.sync(()=>{h.forEach(t=>t&&t())})),this.dispatchEvent(Aa),n&&n()})))}onBeforeRender(n,d,h,t,e,a){this.sync(),e.isTroikaTextMaterial&&this._prepareForRender(e),e._hadOwnSide=e.hasOwnProperty("side"),this.geometry.setSide(e._actualSide=e.side),e.side=Dr}onAfterRender(n,d,h,t,e,a){e._hadOwnSide?e.side=e._actualSide:delete e.side}dispose(){this.geometry.dispose()}get textRenderInfo(){return this._textRenderInfo||null}get material(){let n=this._derivedMaterial;const d=this._baseMaterial||this._defaultMaterial||(this._defaultMaterial=bn.clone());if((!n||n.baseMaterial!==d)&&(n=this._derivedMaterial=Ea(d),d.addEventListener("dispose",function h(){d.removeEventListener("dispose",h),n.dispose()})),this.outlineWidth||this.outlineBlur||this.outlineOffsetX||this.outlineOffsetY){let h=n._outlineMtl;return h||(h=n._outlineMtl=Object.create(n,{id:{value:n.id+.1}}),h.isTextOutlineMaterial=!0,h.depthWrite=!1,h.map=null,n.addEventListener("dispose",function t(){n.removeEventListener("dispose",t),h.dispose()})),[h,n]}else return n}set material(n){n&&n.isTroikaTextMaterial?(this._derivedMaterial=n,this._baseMaterial=n.baseMaterial):this._baseMaterial=n}get glyphGeometryDetail(){return this.geometry.detail}set glyphGeometryDetail(n){this.geometry.detail=n}get curveRadius(){return this.geometry.curveRadius}set curveRadius(n){this.geometry.curveRadius=n}get customDepthMaterial(){return rr(this.material).getDepthMaterial()}get customDistanceMaterial(){return rr(this.material).getDistanceMaterial()}_prepareForRender(n){const d=n.isTextOutlineMaterial,h=n.uniforms,t=this.textRenderInfo;if(t){const{sdfTexture:o,blockBounds:r}=t;h.uTroikaSDFTexture.value=o,h.uTroikaSDFTextureSize.value.set(o.image.width,o.image.height),h.uTroikaSDFGlyphSize.value=t.sdfGlyphSize,h.uTroikaSDFExponent.value=t.sdfExponent,h.uTroikaTotalBounds.value.fromArray(r),h.uTroikaUseGlyphColors.value=!d&&!!t.glyphColors;let i=0,s=0,l=0,u,f,p,m=0,y=0;if(d){let{outlineWidth:F,outlineOffsetX:C,outlineOffsetY:x,outlineBlur:k,outlineOpacity:A}=this;i=this._parsePercent(F)||0,s=Math.max(0,this._parsePercent(k)||0),u=A,m=this._parsePercent(C)||0,y=this._parsePercent(x)||0}else l=Math.max(0,this._parsePercent(this.strokeWidth)||0),l&&(p=this.strokeColor,h.uTroikaStrokeColor.value.set(p??tr),f=this.strokeOpacity,f==null&&(f=1)),u=this.fillOpacity;h.uTroikaDistanceOffset.value=i,h.uTroikaPositionOffset.value.set(m,y),h.uTroikaBlurRadius.value=s,h.uTroikaStrokeWidth.value=l,h.uTroikaStrokeOpacity.value=f,h.uTroikaFillOpacity.value=u??1,h.uTroikaCurveRadius.value=this.curveRadius||0;let O=this.clipRect;if(O&&Array.isArray(O)&&O.length===4)h.uTroikaClipRect.value.fromArray(O);else{const F=(this.fontSize||.1)*100;h.uTroikaClipRect.value.set(r[0]-F,r[1]-F,r[2]+F,r[3]+F)}this.geometry.applyClipRect(h.uTroikaClipRect.value)}h.uTroikaSDFDebug.value=!!this.debugSDF,n.polygonOffset=!!this.depthOffset,n.polygonOffsetFactor=n.polygonOffsetUnits=this.depthOffset||0;const e=d?this.outlineColor||0:this.color;if(e==null)delete n.color;else{const o=n.hasOwnProperty("color")?n.color:n.color=new gn;(e!==o._input||typeof e=="object")&&o.set(o._input=e)}let a=this.orientation||fn;if(a!==n._orientation){let o=h.uTroikaOrient.value;a=a.replace(/[^-+xyz]/g,"");let r=a!==fn&&a.match(/^([-+])([xyz])([-+])([xyz])$/);if(r){let[,i,s,l,u]=r;At.set(0,0,0)[s]=i==="-"?1:-1,un.set(0,0,0)[u]=l==="-"?-1:1,nr.lookAt(Ma,At.cross(un),un),o.setFromMatrix4(nr)}else o.identity();n._orientation=a}}_parsePercent(n){if(typeof n=="string"){let d=n.match(/^(-?[\d.]+)%$/),h=d?parseFloat(d[1]):NaN;n=(isNaN(h)?0:h/100)*this.fontSize}return n}localPositionToTextCoords(n,d=new Gt){d.copy(n);const h=this.curveRadius;return h&&(d.x=Math.atan2(n.x,Math.abs(h)-Math.abs(n.z))*Math.abs(h)),d}worldPositionToTextCoords(n,d=new Gt){return At.copy(n),this.localPositionToTextCoords(this.worldToLocal(At),d)}raycast(n,d){const{textRenderInfo:h,curveRadius:t}=this;if(h){const e=h.blockBounds,a=t?mr():gr(),o=a.geometry,{position:r,uv:i}=o.attributes;for(let s=0;s<i.count;s++){let l=e[0]+i.getX(s)*(e[2]-e[0]);const u=e[1]+i.getY(s)*(e[3]-e[1]);let f=0;t&&(f=t-Math.cos(l/t)*t,l=Math.sin(l/t)*t),r.setXYZ(s,l,u,f)}o.boundingSphere=this.geometry.boundingSphere,o.boundingBox=this.geometry.boundingBox,a.matrixWorld=this.matrixWorld,a.material.side=this.material.side,gt.length=0,a.raycast(n,gt);for(let s=0;s<gt.length;s++)gt[s].object=this,d.push(gt[s])}}copy(n){const d=this.geometry;return super.copy(n),this.geometry=d,Ia.forEach(h=>{this[h]=n[h]}),this}clone(){return new this.constructor().copy(this)}}yr.forEach(c=>{const n="_private_"+c;Object.defineProperty(Ra.prototype,c,{get(){return this[n]},set(d){d!==this[n]&&(this[n]=d,this._needsSync=!0)}})});function za(c,n,d){let h=null;const t=Ga(c);let e=null;return t.forEach(a=>{(!e||Math.abs(d-(a.top+a.bottom)/2)<Math.abs(d-(e.top+e.bottom)/2))&&(e=a)}),e.carets.forEach(a=>{(!h||Math.abs(n-a.x)<Math.abs(n-h.x))&&(h=a)}),h}const ar=new WeakMap;function Wa(c,n,d){let h;if(c){let t=ar.get(c);if(t&&t.start===n&&t.end===d)return t.rects;const{caretPositions:e}=c;if(d<n){const o=n;n=d,d=o}n=Math.max(n,0),d=Math.min(d,e.length+1),h=[];let a=null;for(let o=n;o<d;o++){const r=e[o*4],i=e[o*4+1],s=Math.min(r,i),l=Math.max(r,i),u=e[o*4+2],f=e[o*4+3];(!a||u!==a.bottom||f!==a.top||s>a.right||l<a.left)&&(a={left:1/0,right:-1/0,bottom:u,top:f},h.push(a)),a.left=Math.min(s,a.left),a.right=Math.max(l,a.right)}h.sort((o,r)=>r.bottom-o.bottom||o.left-r.left);for(let o=h.length-1;o-- >0;){const r=h[o],i=h[o+1];r.bottom===i.bottom&&r.top===i.top&&r.left<=i.right&&r.right>=i.left&&(i.left=Math.min(i.left,r.left),i.right=Math.max(i.right,r.right),h.splice(o,1))}ar.set(c,{start:n,end:d,rects:h})}return h}const or=new WeakMap;function Ga(c){let n=or.get(c);if(!n){n=[];const{caretPositions:d}=c;let h;const t=(a,o,r,i)=>{(!h||r<(h.top+h.bottom)/2)&&n.push(h={bottom:o,top:r,carets:[]}),r>h.top&&(h.top=r),o<h.bottom&&(h.bottom=o),h.carets.push({x:a,y:o,height:r-o,charIndex:i})};let e=0;for(;e<d.length;e+=4)t(d[e],d[e+2],d[e+3],e/4);t(d[e-3],d[e-2],d[e-1],e/4)}return or.set(c,n),n}export{wa as GlyphsGeometry,Ra as Text,La as configureTextBuilder,Ea as createTextDerivedMaterial,ja as dumpSDFTextures,la as fontResolverWorkerModule,za as getCaretAtPoint,Wa as getSelectionRects,cr as getTextRenderInfo,Pa as preloadFont,xa as typesetterWorkerModule};
